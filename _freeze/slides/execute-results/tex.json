{
  "hash": "2ff635559ce6699a30845c7798ee13c7",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Introduction to Infectious Disease Modelling\"\nauthor: \"James Mba Azam, PhD\"\nexecute:\n  echo: true\nformat: beamer\n# format:\n  # revealjs: \n  #   theme: [solarized, custom.scss]\n  #   slide-number: true\n  #   scrollable: true\n  #   chalkboard: true\n# revealjs-plugins:\n#   - revealjs-text-resizer\nbibliography: references.bib\nlink-citations: true\nengine: knitr\n---\n\n\n\n# An overview of infectious diseases\n\n## What are infectious diseasess\n\n::: columns\n::: {.column width=\"50%\"}\n![Generic definition of a disease (source: Merriam Webster)](images/disease_definition.png){.lightbox}\n:::\n\n::: {.column width=\"50%\"}\nDepending on what we care about, we can classify diseases according to:\n\n-   Cause (e.g., infectious, non-infectious)\n-   Duration (e.g., acute, chronic)\n-   Mode of transmission (direct or indirect)\n-   Impact on the host (e.g., fatal, non-fatal)\n:::\n:::\n\n---\n\n- Note that these classifications are not mutually exclusive. Hence, a disease can be classified under more than one category at a time.\n\n---\n\n## How are infectious diseases controlled? {#sec-control-measures}\n\n-   In general, infectious disease control aims to reduce disease transmission.\n-   The type of control used depends on the disease and its characteristics.\n-   Broadly, there are two main types of control measures:\n    -   Pharmaceutical interventions (PIs)\n    -   Non-pharmaceutical interventions (NPIs)\n\n------------------------------------------------------------------------\n\n### Pharmaceutical interventions (PIs)\n\n-   Pharmaceutical Interventions are medical interventions that target the pathogen or the host.\n\n-   Examples:\n\n    -   Vaccines,\n    -   Antiviral drugs, and\n    -   Antibiotics.\n\n------------------------------------------------------------------------\n\n#### Vaccination {#sec-vaccination}\n\n-   Most effective way to prevent infectious diseases.\n-   Activates the host's immune system to produce antibodies against the pathogen.\n-   Generally applied prophylactically to susceptible individuals (before infection); this reduces the risk of infection and disease.\n\n---\n\n-   Challenges with vaccination:\n    -   Take time to develop for new pathogens\n    -   Never 100% effective and limited duration of protection\n    -   Adverse side effects\n    -   Some individuals cannot be vaccinated or refuce vaccination\n    -   Some pathogens mutate rapidly (e.g., influenza virus)\n\n------------------------------------------------------------------------\n\n### Non-pharmaceutical interventions (NPIs) {#sec-npi}\n\n-   Non-pharmaceutical interventions are measures that do not involve medical interventions.\n\n-   Examples:\n\n    -   Quarantine,\n    -   Physical/social distancing, and\n    -   Mask-wearing.\n\n------------------------------------------------------------------------\n\n#### Quarantine\n\n-   *Isolation of individuals who may have been exposed to a contagious disease*.\n-   Advantage is that it's simple and its effectiveness does not depend on the disease.\n-   Disadvantages include:\n    -   Infringement on individual rights\n    -   Can be difficult to enforce\n    -   Can be costly\n    -   Can lead to social stigma\n\n------------------------------------------------------------------------\n\n#### Contact tracing\n\n-   Contact tracing is used to identify exposed individuals, i.e., individuals who might been in contact with an infected/infectious individual.\n-   It involves identifying, assessing, and managing people who have been exposed to a contagious disease to prevent further transmission.\n-   It is a critical component of infectious disease surveillance and is often used in combination with other control measures.\n\n------------------------------------------------------------------------\n\n::: {.callout-caution collapse=\"true\" icon=false}\n\n### Discussion\n\n- How can we quantify the impact of a control measure?\n:::\n\n# Infectious disease models\n\n## What are infectious disease models?\n\n-   [*Models*]{style=\"color:red;\"} generally refer to conceptual representations of an object or system.\n-   [*Mathematical models*]{style=\"color:red;\"} use mathematics to describe the system. For example, the famous $E = mc^2$ is a mathematical model that describes the relationship between mass and energy.\n-   [*Infectious disease models*]{style=\"color:red;\"} use mathematics/statistics to represent dynamics/spread of infectious diseases.\n\n------------------------------------------------------------------------\n\n-   Mathematical models can be used to link the biological process of disease transmission and the emergent dynamics of infection at the population level.\n-   Models require making some assumptions and abstractions.\n\n---\n\n::: columns\n::: {.column width=\"60%\"}\n-   By definition, \"all models are wrong, but some are useful\" [@Box1979].\n    -   Good enough models are those that capture the essential features of the system being studied.\n:::\n\n::: {.column width=\"40%\"}\n![By DavidMCEddy at en.wikipedia, CC BY-SA 3.0, https://commons.wikimedia.org/w/index.php?curid=115167166](images/GeorgeEPBox.jpeg){.lightbox}\n:::\n:::\n\n---\n\n-   \"Wrong\" here means that models are simplifications of reality and do not capture all the complexities of the system being studied. It does not mean that models are useless.\n\n---\n\n### \"All models are wrong, but some are useful\"\n\n::: columns\n::: {.column width=\"50%\"}\nFor example, linear regression models:\n\n- Assume a linear relationship between the dependent and independent variables. \n- Assume that the residuals are normally distributed.\n:::\n::: {.column width=\"50%\"}\n\n\n\n::: {.cell output-location='slide'}\n::: {.cell-output-display}\n![](slides_files/figure-beamer/linear-regression-1.pdf)\n:::\n:::\n\n\n:::\n:::\n\n------------------------------------------------------------------------\n\n## Factors that influence model formulation/choice\n\n-   Accuracy: how well does the model to reproduce observed data and predict future outcomes?\n-   Transparency: is it easy to understand and interpret the model and its outputs? (This is affected by the model's complexity)\n-   Flexibility: the ability of the model to be adapted to different scenarios.\n\n---\n\n## What are models used for?\n\n-   Generally, models can be used to predict and understand/explain the dynamics of infectious diseases.\n\n::: {.callout-caution collapse=\"true\" icon=false}\n### Discussion\n\nHow are these two uses impacted by accuracy, transparency, and flexibility?\n:::\n\n------------------------------------------------------------------------\n\n### Prediction of the future course\n\n::: columns\n::: {.column width=\"40%\"}\n-   Must be [accurate]{style=\"color:red;\"} else they will provide an incorrect outlook of the future.\n-   Example of the [prediction of Ebola deaths](https://apnews.com/domestic-news-domestic-news-fbb4fc8921d54201a1c5ca91e5b601f5) during the outbreak in West Africa in 2014/2015.\n-   \"But the estimate proved to be off. Way, way off. Like, 65 times worse than what ended up happening.\"\n:::\n\n::: {.column width=\"60%\"}\n![Controversy over estimates of Ebola deaths](images/wrong_ebola_deaths_estimate.png){.lightbox}\n:::\n:::\n\n------------------------------------------------------------------------\n\n\\< Insert examples of models that have made accurate predictions of the future course of an outbreak \\>\n\n------------------------------------------------------------------------\n\n### Understanding or explaining disease dynamics \n\n-   Models can be used to understand how a disease spreads and how its spread can be controlled.\n-   The insights gained from models can be used to:\n    -   inform public health policy and interventions.\n    -   design interventions to control the spread of the disease, for example, randomised controlled trials.\n    -   collect new data.\n    -   build predictive models.\n\n---\n\n\\< Insert examples of models that explain the spread and dynamics of infectious diseases \\>\n\n---\n\n\\< Insert examples of models that evaluate the impact of interventions and determine the next course of action \\>\n\n---\n\n## Limitations of infectious disease models\n\n-   Host behaviour is often difficult to predict.\n-   The pathogen often has unknown characteristics or known characteristics that are difficult to model.\n-   Data is often not available or is of poor quality.\n\n---\n\n-   Models:\n    -   Simplifications of reality and do not capture all the complexities of the system being studied.\n    -   Only as good as the data used to parameterize them.\n    -   Can be sensitive to the assumptions made during their formulation.\n    -   Can be computationally expensive and require a lot of data to run.\n    -   Can be difficult to interpret and communicate to non-experts.\n\n# Introduction to compartmental models\n\n## What are compartmental models?\n\n-   Compartmental models:\n    - divide populations into compartments (or groups) based on the individual's infection status and track them through time [@Blackwood2018a].\n    -  are mechanistic, meaning they describe processes such the interaction between hosts, biological processes of pathogen, host immune response, and so forth.\n    \n---\n\n-   Individuals in a compartment:\n    - are assumed to have the same features (disease state, age, location, etc)\n    - can only be in one compartment at a time.\n    - move between compartments based on defined transition rates.\n\n---\n\n::: columns\n::: {.column width=\"60%\"}\n-   Common compartments:\n    -   Susceptible (S) - hosts are not infected but can be infected\n    -   Infected (I) - hosts are infected (and can infect others)\n    -   Removed (R) - hosts are no longer infected and cannot be re-infected\n:::\n\n::: {.column width=\"40%\"}\n![Infection timeline illustrating how a pathogen in a host interacts with the host's immune system (Source: Modelling Infectious Diseases of Humans and Animals)](images/infection_timeline.png){.lightbox}\n:::\n:::\n\n---\n\n- Other compartments can be added to the model to account for important events or processes (e.g., exposed, recovered, vaccinated, etc.)\n\n- It is, however, important to keep the model simple, less computationally intensive, and interpretable.\n\n---\n\n- Compartmental models either have _discrete_ or _continuous_ time scales:\n  - [Discrete time scales]{style=\"color:tomato;\"}: time is divided into discrete intervals (e.g., days, weeks, months).\n  - [Continuous time scales]{style=\"color:tomato;\"}: time is continuous and the model is described using differential equations.\n\n---\n\n- Compartmental models can be _deterministic_ or _stochastic_:\n  - [Deterministic]{style=\"color:tomato;\"} models always return the same output for the same input.\n  - [Stochastic]{style=\"color:tomato;\"} models account for randomness in the system and model output always varies. Hence, they are often run multiple times to get an average output.\n\n---\n\n- The choice of model type depends on the research question, data availability, and computational resources.\n\n- In this introduction, we will focus on [deterministic compartmental models with continuous time scales]{style=\"color:tomato;\"}. \n\n---\n\n- Now, back to the models, we are going to consider infections that either confer immunity after recovery or not.\n- The simplest compartmental models for capturing this are the SIS and SIR models.\n\n---\n\n## The Susceptible-Infected-Recovered (SIR) model\n\n::: columns\n::: {.column width=\"50%\"}\n- Used to model diseases that confer immunity after recovery. For example, measles and chicken pox.\n- Popularised by Kermack and McKendrick in 1927 [@kermack1927contribution]\n  - A must-read paper for budding infectious disease modellers.\n:::\n\n::: {.column width=\"50%\"}\n![Diagram of an SIR model](images/model_diagrams/model_diagrams.001.png){.lightbox}\n:::\n:::\n\n---\n\n::: columns\n::: {.column width=\"60%\"}\n- The SIR model groups individuals into three _disease states_:\n  - [Susceptible (S)]{style=\"color:green;\"}: individuals who are not infected and can be infected.\n  - [Infected (I)]{style=\"color:tomato;\"}: individuals who are infected and can infect others.\n  - [Removed (R)]{style=\"color:blue;\"}: individuals who have recovered from the infection and are immune.\n:::\n\n::: {.column width=\"40%\"}\n![Diagram of an SIR model](images/model_diagrams/model_diagrams.001.png){.lightbox}\n:::\n:::\n\n---\n\n### How do individuals move between compartments?\n\n- There are two processes that govern the transitions between compartments:\n  - [Transmission]{style=\"color:orange;\"}, governed by the transmission rate, $\\beta$ (rate at which susceptible individuals become infected).\n  - [Recovery]{style=\"color:orange;\"}, governed by the recovery rate, $\\gamma$ (rate at which infected individuals recover and become immune).\n\n---\n\n### Model assumptions\n\n- There are no inflows or outflows from the population, i.e., no births, deaths, or migration. This is often described as a _closed population_.\n  - That is, the epidemic occurs much faster than the time scale of births, deaths, or migration.\n  \n- Individuals are infectious immediately after infection and remain infectious until they recover.\n\n---\n\n- Mixing is _homogeneous_, i.e., [individuals mix randomly]{style=\"color:orange;\"} and have an equal probability of coming into contact with any other individual in the population.\n\n- Transition rates are constant and do not change over time.\n\n- Individuals acquire \"lifelong\" immunity after recovery.\n\n---\n\n### Formulating the model equations\n\n- Continuous time compartmental models are often formulated using differential equations that describe the change in the number of individuals in each compartment over time.\n\n- The SIR model can be formulated by identifying the events/processes that cause individuals to move between compartments:\n  - [Transmission]{style=\"color:orange;\"}: susceptible individuals become infected.\n  - [Recoveries]{style=\"color:orange;\"}: infected individuals recover.\n\n- Let's break these two processes down further.\n\n---\n\n### Process 1: Transmission\n\n::: {.callout-caution collapse=\"true\" icon=false}\n#### Discussion\n\n- What factors drive transmission?\n:::\n\n---\n\n- Transmission is driven by several factors:\n  - The prevalence, [$I$]{style=\"color:orange;\"}, i.e., number of infected individuals at the time.\n  - The number of contacts, [$C$]{style=\"color:orange;\"}, susceptible individuals have with infected individual.\n  - The probability, [$p$]{style=\"color:orange;\"}, a susceptible individual will become infected when they contact an infected individual.\n\n---\n\n- The transmission term is often defined through the force of infection (FOI), $\\lambda$:\n  - the [per capita rate]{style=\"color:orange;\"} at which susceptible individuals become infected.\n\n- The rate at which new infecteds are generated is given by [$\\lambda S$]{style=\"color:orange;\"}, where $S$ is the number of susceptible individuals.\n\n- The force of infection is proportional to the number of infected individuals and the transmission rate, [$\\beta$]{style=\"color:orange;\"}.\n\n- $\\beta$ is the product of the contact rate and the probability of transmission per contact.\n\n---\n\n- The FOI can be formulated in two ways, depending on how the contact rate is expected to change with the population size:\n  - [_Frequency-dependent/mass action transmission_]{style=\"color:orange;\"}: The rate of contact between individuals is proportional to the population size. Here, [$\\lambda = \\beta \\times \\dfrac{I}{N}$]{style=\"color:orange;\"}.\n  - [_Density dependent transmission_]{style=\"color:orange;\"}: The rate of contact between individuals is independent of the population size. Here, [$\\lambda = \\beta \\times I$]{style=\"color:orange;\"}.\n\n---\n\n- [Frequency-dependent]{style=\"color:tomato;\"} transmission assumes that that the number of contacts an individual has does not depend on the population size:\n  - Here, the interaction between susceptible and infected individuals does not change with the population size.\n  - Often used to model sexually-transmitted diseases and diseases with heterogeneity in contact rates.\n  - Sexual transmission in this case does not depend on how many infected individuals are in the population.\n\n---\n\n- [Density-dependent]{style=\"color:tomato;\"} transmission assumes that the number of contacts an individual has is proportional to the population size:\n  - It impacts the interaction between susceptible and infected individuals.\n  - Can be used to model airborne and directly transmitted diseases, for example, measles.\n\n::: {.callout-note}\n- The differences become important when dealing with population sizes that change significantly over time.\n- We will mostly use the density-dependent formulation in this course.\n:::\n\n---\n\n### Process 2: Recovery\n\n- Individuals recover after having been infected for the duration of infection.\n\n- The [recovery rate, $\\gamma$]{style=\"color:tomato\"}, is the reciprocal of the average duration of the infection.\n\n- Infected individuals spend $1/\\gamma$ days in the infected compartment before recovering.\n\n- The average infectious period is often estimated from epidemiological data:\n  - You will learn about parameter estimation in a future lecture.\n\n---\n\nPutting it all together, the SIR model can be formulated as a set of differential equations:\n\n::: columns\n::: {.column width=\"50%\"}\n![](images/model_diagrams/model_diagrams.001.png){.centered .lightbox fig-align=\"center\"}\n:::\n\n::: {.column width=\"50%\"}\n\\begin{align}\n\\frac{dS}{dt} & = \\color{orange}{-\\beta \\frac{S I}{N}} \\\\\n\\frac{dI}{dt} & = \\color{orange}{\\beta \\frac{S I}{N}} - \\color{blue}{\\gamma I} \\\\\n\\frac{dR}{dt} & = \\color{blue}{\\gamma I}\n\\end{align}\n:::\n:::\n\nwhere [$\\beta$]{style=\"color:orange;\"} is the transmission rate, and [$\\gamma$]{style=\"color:orange;\"} is the recovery rate.\n\n---\n\nWith initial conditions $S(0) = N - 1$, $I(0) = 1$, and $R(0) = 0$.\n\nwhere $N$ is the total population size.\n\n#### Some things to note\n\n- We represent the compartments as [population sizes]{style=\"color:orange;\"}.:\n  - Some modellers often use [proportions]{style=\"color:orange;\"} instead of population sizes as a way to remove the dimensions from the equations.\n\n\n---\n\n### What questions can we answer with the SIR model?\n\n- The SIR model can be used to understand the dynamics of an epidemic:\n  - How long will the epidemic last?\n  - How many individuals will be infected (final epidemic size)?\n  - When will the epidemic reach its peak?\n\n---\n\n## Solving the SIR model\n\n- Compartmental models cannot be solved analytically.\n\n- Other methods are used to understand the dynamics of the model:\n  - Qualitative analysis of the equations; threshold phenomena.\n  - Numerical simulations.\n\n---\n\n### Threshold phenomena\n\n- Here, we study the conditions under which an epidemic will grow or die out using the model equations.\n\n- Consider the case where $I(0) = 1$ individual is introduced into a population of size $N$ at time $t = 0$.\n\n- That means in a completely susceptible population, we have $S(0) = N - 1$ susceptible individuals.\n\n---\n\n- At time 0, the disease will not spread if the rate of change of infections is negative, that is $\\dfrac{dI}{dt} < 0$.\n\n- Recall from the SIR model that $\\dfrac{dI}{dt} = \\beta\\dfrac{S I}{N} - \\gamma I$\n\n- Let's solve this equation at $t = 0$ by setting $S = N - 1$ and $I = 1$, assuming $\\dfrac{dI}{dt} < 0$.\n\n---\n\n- At $t = 0$, we have\n\n\\begin{equation*}\n\\frac{dI}{dt} = \\beta \\times \\frac{N - 1}{N} \\times 1  - \\gamma I < 0 \\end{equation*}\n\n- Re-arranging the equation, we get\n\n\\begin{equation*}\n\\dfrac{\\beta}{\\gamma} \\times \\left( \\frac{N - 1}{N} \\right) < 1\n\\end{equation*}\n\n---\n\n- For very large populations, $\\dfrac{N - 1}{N} \\approx 1$, and the equation simplifies to $\\dfrac{\\beta}{\\gamma} < 1$.\n\n- This implies that the epidemic will not grow if $\\dfrac{\\beta}{\\gamma} < 1$.\n\n- This is the threshold condition for the epidemic to die out. The epidemic will grow if $\\dfrac{\\beta}{\\gamma} > 1$.\n\n- For the SIR model, the quantity $\\dfrac{\\beta}{\\gamma}$ is called the reproduction number, $R0$ (pronounced \"R naught\" or \"R zero\").\n\n---\n\n#### The basic reproduction number, R0\n\n- The basic reproduction number, [$R0$]{style=\"color:tomato\"}, is the average number of secondary infections generated by a [single primary infection]{style=\"color:tomato\"} in a [completely susceptible]{style=\"color:tomato\"} population.\n\n- The basic reproduction number is a key quantity in infectious disease epidemiology.\n\n---\n\n- It is often represented as a single number or a range of high-low values.\n    - For example, the $R0$ for measles is popularly known to be $12$ - $18$ [@guerra2017measlesR0].\n    \n- For an insightful historical account of the evolution of $R0$ derivations, see [@heesterbeek2002brief].\n\n---\n\n- $R0$ is often used to express the threshold phenomena in infectious disease epidemiology:\n  - If $R0 > 1$, the epidemic will grow.\n  - If $R0 < 1$, the epidemic will decline.\n\n- A pathogen's $R0$ value is determined by biological characteristics of the pathogen and the host's behaviour.\n\n---\n\n- Conceptually, $R0$ is given by\n\n\\begin{equation*}\n\\begin{split}\n\\text{Probability of infection given contact} \\times \\\\\n\\text{Number of contacts per unit time} \\times \\\\\n\\text{Duration of infectiousness}\n\\end{split}\n\\end{equation*}\n\nand mathematically,\n\n$$\nR0 \\propto \\dfrac{\\text{Infection}}{\\text{Contact}} \\times \\dfrac{\\text{Contact}}{\\text{Time}} \\times \\dfrac{\\text{Time}}{\\text{Infection}}\n$$\n\n- $R0$ is therefore unitless and dimensionless.\n\n---\n\n#### The next-generation matrix approach\n\n- The method used to derive $R0$ in the SIR model is possible because there is only one compartment with infected individuals.\n\n- In more complex models, $R0$, this method becomes impossible to use.\n\n- A more general method would be to use the next-generation matrix approach.\n\n---\n\n<Insert slides on next-generation matrix approach for deriving $R0$ for SEIR>\n\n---\n\n### Numerical simulations\n\n- Numerical simulations can be performed with any programming language.\n\n- This course focuses on the R programming language:\n  - In R, we can use the `deSolve` package to solve the differential equations.\n\n---\n\n- To solve the model in R, we will always need to define at least three things:\n  - The model equations.\n  - The initial parameter values.\n  - The initial conditions (population sizes).\n\n---\n\n- Let's start by defining the model equations.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define the SIR model\nsir_model <- function(t, state, parameters) {\n  with(as.list(c(state, parameters)), {\n    dS <- -beta * S * I\n    dI <- beta * S * I - gamma * I\n    dR <- gamma * I\n    return(list(c(dS, dI, dR)))\n  })\n}\n```\n:::\n\n\n\n---\n\nNext, we will define the parameter values and initial conditions.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# define parameters we know\nN  <- 1  \nR0 <- 10\ninfectious_period <- 7\n\n# Remember gamma <- 1/ infectious_period as discussed earlier\ngamma <- 1/infectious_period \n\n# We will use R0 = beta N / gamma  instead because it is easier to interpret.\n# beta is not directly interpretable.\n\nparams <- c(beta = R0 * gamma / N, gamma = gamma)\n\n# Initial conditions for S, I, R\n# Why is S = N - 1?\ninits <- c(S = N - 0.001, I = 0.000001, R = 0)\n\n# Time steps to return results\ndt <- 1:70\n```\n:::\n\n\n\n---\n\nFinally, we will solve the model using the `ode()` function from the `deSolve` package. For now, we will use the default values of the function.\nYou are encouraged to explore the documentation to understand the function better.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Solve the model\nresults <- deSolve::ode(\n  y = inits,\n  times = dt,\n  func = sir_model,\n  parms = params\n)\n\n# Make it a data.frame\nresults <- as.data.frame(results)\n```\n:::\n\n\n\n---\n\nNow, let's plot the results.\n\n\n\n::: {.cell output-location='slide'}\n\n```{.r .cell-code}\n# Load the necessary libraries\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\n# Create data for ggplot2 by reshaping\nresults_long <- results |>\n  pivot_longer(\n    cols = c(2:4),\n    names_to = \"compartment\",\n    values_to = \"value\"\n  )\n\nplot <- ggplot(\n  data = results_long,\n  aes(\n    x = time,\n    y = value,\n    color = compartment\n  )\n) +\n  geom_line(linewidth = 1) +\n  labs(\n    title = \"SIR model\",\n    x = \"Time\",\n    y = \"Number of individuals\"\n  )\nprint(plot)\n```\n\n::: {.cell-output-display}\n![](slides_files/figure-beamer/plot-sir-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n---\n\n## The Susceptible-Exposed-Infected-Recovered (SEIR) Model\n\n- Many diseases have an incubation period during which individuals are infected but not yet infectious. Examples include COVID-19 and Ebola.\n- Disease transmission can occur during the incubation period, but the individual is not yet infectious.\n- Capturing this incubation period is essential for understanding the dynamics of the disease and the impact of control measures.\n\n---\n\n::: columns\n::: {.column width=\"50%\"}\n![](images/model_diagrams/model_diagrams.002.png){.lightbox}\n:::\n\n::: {.column width=\"50%\"}\n- The SEIR model extends the SIR model to include an exposed compartment, $E$.\n- The exposed compartment represents individuals who have been infected but are not yet infectious.\n- Individuals stay in the exposed compartment for a period of time ($1/\\sigma)$ before moving to the infectious compartment.\n:::\n:::\n\n---\n\n::: columns\n::: {.column width=\"40%\"}\n![](images/model_diagrams/model_diagrams.002.png){.lightbox}\n:::\n\n::: {.column width=\"60%\"}\n\nModel equations: \n\\begin{align}\n\\frac{dS}{dt} & = -\\beta \\frac{S I}{N} \\\\\n\\frac{dE}{dt} & = \\beta \\frac{S I}{N} - \\sigma E \\\\\n\\frac{dI}{dt} & = \\sigma E - \\gamma I \\\\\n\\frac{dR}{dt} & = \\gamma I\n\\end{align}\n:::\n:::\n\n---\n\n### The $R0$ of the SEIR Model\n\n<Insert slides on next generation matrix approach>\n\n---\n\n### Numerical simulations\n\n- We can use the same approach as the SIR model to simulate the SEIR model.\n\n- Let's do a code walk though in R.\n\n---\n\n# Controlling epidemics\n\n::: {.callout-note}\n- For a recap on the various control measures, refer to @sec-control-measures.\n:::\n\n---\n\n## Modelling vaccination\n\n::: {.callout-note}\n- For a background on vaccination, refer to @sec-vaccination.\n:::\n\n- Conceptually, vaccination works to reduce the number of susceptible individuals, $S$.\n- The SIR and SEIR model can be extended to include vaccination by adding a new compartment, $V$.\n\n- Let's consider the SEIR model with vaccination.\n\n---\n\n### The Susceptible-Exposed-Infected-Recovered-Vaccinated (SEIRV) Model\n\n- The SEIRV model is simply the SEIR model with a vaccinated compartment, $V$.\n\n- The vaccinated compartment represents previously susceptible individuals who have been vaccinated and are immune to the disease.\n\n- The vaccinated compartment is not infectious and does not move to the exposed or infectious compartments.\n\n- The vaccinated compartment is replenished by the rate of vaccination, $\\eta$.\n\n---\n\nThe model diagram and equations are as follows:\n\n::: columns\n::: {.column width=\"40%\"}\n\\begin{align}\n\\frac{dS}{dt} & = -\\beta \\frac{S I}{N} - \\eta S \\\\\n\\frac{dE}{dt} & = \\beta \\frac{S I}{N} - \\sigma E \\\\\n\\frac{dI}{dt} & = \\sigma E - \\gamma I \\\\\n\\frac{dR}{dt} & = \\gamma I \\\\\n\\frac{dV}{dt} & = \\eta S\n\\end{align}\n:::\n\n::: {.column width=\"60%\"}\n![](images/model_diagrams/model_diagrams.003.png){.lightbox}\n:::\n:::\n\nwhere $\\eta$ is the rate of vaccination.\n\n---\n\n::: {.callout-caution collapse=\"true\" icon=false}\n\n#### Discussion\n\n- What are some of the assumptions of the SEIRV model?\n\n- What are the implications of these assumptions for the model's predictions?\n:::\n\n---\n\n### Numerical simulations\n\n- We can use the same approach as the SIR and SEIR models to simulate the SEIRV model.\n\n- Let's do a code walk though in R.\n\n---\n\n## Modelling NPIs\n\n::: {.callout-note}\n- For a background on non-pharmaceutical interventions, refer to @sec-npi.\n:::\n\n- Conceptually, NPIs usually act to either reduce the transmission rate, $\\beta$\nor prevent infected individuals from transmitting.\n\n- Let's consider two scenarios that will extend the SIR model:\n  1. Reducing the transmission rate, $\\beta$.\n  2. Preventing infected individuals from transmitting through isolation.\n\n---\n\n### Reducing the transmission rate\n\n- NPIs such as social distancing, mask-wearing, and hand hygiene can reduce the transmission rate, $\\beta$.\n\n- We can model this by introducing a reduction factor, $\\alpha$, that reduces transmission rate, $\\beta$.\n\n---\n\nThe modified SIR model with a reduced transmission rate is as follows:\n\n\\begin{align}\n\\frac{dS}{dt} & = -\\alpha\\beta \\frac{S I}{N} \\\\\n\\frac{dI}{dt} & = \\alpha \\beta \\frac{S I}{N} - \\gamma I \\\\\n\\frac{dR}{dt} & = \\gamma I\n\\end{align}\n\nwhere $\\alpha$ is the reduction factor, and $0 \\leq \\alpha \\leq 1$.\n\n---\n\n#### Scenarios with reduced transmission rate\n\n- We can use the same approach as the SIR model to simulate the model with a reduced transmission rate.\n\n- Let's do a code walk though in R.\n\n---\n\n### Modelling quarantine\n\n- Isolation is a key NPI that prevents infected individuals from transmitting the disease.\n\n- We can model this by introducing a new compartment, $Q$, for quarantining infected individuals.\n\n- Infected individuals move to the quarantine compartment at a rate, $\\delta$.\n\n- Infected individuals in the quarantine compartment do not transmit the disease.\n\n---\n\nThe modified SIR model with quarantine is as follows:\n\n\\begin{align}\n\\frac{dS}{dt} & = -\\beta \\frac{S I}{N} \\\\\n\\frac{dI}{dt} & = \\beta \\frac{S I}{N} - \\gamma I - \\delta I \\\\\n\\frac{dR}{dt} & = \\gamma I + \\tau Q \\\\\n\\frac{dQ}{dt} & = \\delta I - \\tau Q\n\\end{align}\n\nwhere $\\delta$ is the rate at which infected individuals move to the quarantine compartment, and $\\tau$ is the rate at which individuals recover from quarantine.\n\n---\n\n#### Scenarios with quarantine\n\n- We can use the same approach as the SIR model to simulate the model with quarantine.\n\n- Let's do a code walk though in R.\n\n# Incorporating host heterogeneity\n\n- The models we have discussed so far assume that all individuals in the population are identical.\n\n- However, in reality, individuals differ in their susceptibility to infection and their ability to transmit the disease.\n\n- It is essential to capture this heterogeneity in the models in order for the models to be more realistic and useful for decision-making.\n\n---\n\n- This can be captured by incorporating heterogeneity into the models.\n\n- Heterogeneity is often captured by stratifying the population into different groups.\n\n---\n\n## Incorporating age structure\n\n- For many infectious diseases, the risk of infection and the severity of the disease vary by age.\n\n- Hence, it is essential to capture age structure in the models.\n\n- To do this, we divide the population into different age groups and model the disease dynamics within each age group.\n\n- Let's extend the SIR model to include age structure.\n\n---\n\n- We will divide the population into $n$ age groups.\n\n- Because the homogeneous model has 3 compartments, the age structured one will have $3n$ compartments: $S_1, I_1, R_1, S_2, I_2, R_2, ..., S_n, I_n, R_n$.\n\n---\n\n- The (compact) model equations are as follows:\n\n\\begin{align}\n\\dfrac{dS_i}{dt} &= -\\sum_{j=1}^{n} \\beta_{ji} S_i I_j \\\\\n\\dfrac{dI_i}{dt} &= \\sum_{j=1}^{n} \\beta_{ji} S_i I_j - \\gamma I_i \\\\\n\\dfrac{dR_i}{dt} &= \\gamma I_i\n\\end{align}\n\n---\n\n- The model can be used to study the impact of age structure on the dynamics of the epidemic.\n\n- For example, we can study the impact of vaccinating different age groups on the dynamics of the epidemic.\n\n---\n\n## Other Heterogeneities\n\n- Other forms of heterogeneity that can be incorporated into the models include:\n\n  - Spatial heterogeneity\n  - Temporal heterogeneity\n  - Contact heterogeneity\n\n# Wrap-Up and Q&A\n\n## Takeaways\n\nIn the last two days, we have covered a lot of ground. Here are some key takeaways:\n\n- Infectious diseases are a major public health concern that can have devastating consequences.\n\n- Mathematical models are essential tools for studying the dynamics of infectious diseases and informing public health decision-making.\n\n- Models are simplifications of reality that help us understand complex systems.\n\n---\n\n- We have discussed several compartmental models, including the SIR, SEIR, and SEIRV models.\n\n- The SIR model is a simple compartmental model that divides the population into three compartments: susceptible, infected, and recovered.\n\n- The SEIR model extends the SIR model by adding an exposed compartment.\n\n- We can model various pharmaceutical and non-pharmaceutical interventions (NPIs) by modifying the transmission rate or adding new compartments.\n\n---\n\n- We have discussed the basic reproduction number, $R0$, which is a key parameter in infectious disease epidemiology.\n\n- $R0$ is the average number of secondary infections produced by a single infected individual in a completely susceptible population.\n\n- If $R0 > 1$, the disease will spread in the population; if $R0 < 1$, the disease will die out.\n\n---\n\n- Deriving the basic reproduction number, $R0$, is an essential step in understanding the dynamics of infectious diseases.\n\n- Deriving $R0$ for the simple SIR model is simple as we just need to study the threshold phenomena.\n\n- For more complex models, we can use the next-generation matrix approach to derive $R0$.\n\n---\n\n- Often, homogeneous models are not sufficient to capture the complexity of infectious diseases.\n\n- Incorporating heterogeneity into the models is essential for capturing the complexity of infectious diseases.\n\n- Age structure is a common form of heterogeneity that can be incorporated into the models.\n\n- Other forms of heterogeneity include spatial, temporal, and contact heterogeneity.\n\n---\n\n## What skills are needed to build and use infectious disease models?\n\n### Mathematical and statistical skills\n\n-   Differential equations.\n-   Probability and statistics.\n-   Stochastic processes.\n-   Numerical analysis\n-   Time series analyses\n-   Survival analysis\n\n---\n\n### Programming skills\n\n-   Proficiency in at least one programming language (e.g., R, Python, Julia, C++).\n-   Experience with version control (e.g., Git).\n-   Experience with data manipulation and visualization.\n\n---\n\n### Domain knowledge in infectious diseases\n\n-   Immunology\n-   Epidemiology\n-   Virology\n-   Genomics\n    \n---\n\n### Other subject areas\n\n  - Communication skills:\n    -   Ability to communicate complex ideas to non-experts.\n    -   Ability to write clear and concise reports.\n    -   Ability to present results to a diverse audience.\n  -   Public health.\n  -   Health economics.\n  - Policy analysis.\n\n# List of Resources\n\n---\n\n## Textbooks\n\n-   [Modeling Infectious Diseases in Humans and Animals by Matt Keeling and Pejman Rohani](https://www.amazon.co.uk/Modeling-Infectious-Diseases-Humans-Animals/dp/0691116172) -[Epidemics: Models and Data Using R by Ottar N. Bjornstad](https://link.springer.com/book/10.1007/978-3-031-12056-5)\n-   [Infectious Disease Modelling by Emilia Vynnycky and Richard White](https://www.amazon.co.uk/Introduction-Infectious-Disease-Modelling/dp/0198565763)\n-   [Infectious Diseases of Humans: Dynamics and Control by Roy M. Anderson and Robert M. May](https://www.amazon.co.uk/Infectious-Diseases-Humans-Dynamics-Control/dp/019854040X)\n\n---\n\n## Papers and Articles {.scrollable}\n\n### Modelling infectious disease transmission\n\n-   [Kirkeby, C., Brookes, V. J., Ward, M. P., Dürr, S., & Halasa, T. (2021). A practical introduction to mechanistic modeling of disease transmission in veterinary science. Frontiers in veterinary science, 7, 546651.](https://www.frontiersin.org/articles/10.3389/fvets.2020.546651/full)\n-   [Blackwood, J. C., & Childs, L. M. (2018). An introduction to compartmental modeling for the budding infectious disease modeler.](https://vtechworks.lib.vt.edu/items/61e9ca00-ef21-4356-bcd7-a9294a1d2f17)\n-   [Grassly, N. C., & Fraser, C. (2008). Mathematical models of infectious disease transmission. Nature Reviews Microbiology, 6(6), 477–487.](https://doi.org/10.1038/nrmicro1845)\n\n---\n\n-   [Cobey, S. (2020). Modeling infectious disease dynamics. Science, 368(6492), 713–714.](https://doi.org/10.1126/science.abb5659)\n-   [Bjørnstad, O. N., Shea, K., Krzywinski, M., & Altman, N. (2020). Modeling infectious epidemics. Nature Methods, 17(5), 455–456.](https://doi.org/10.1038/s41592-020-0822-z)\n-   [Bodner, K., Brimacombe, C., Chenery, E. S., Greiner, A., McLeod, A. M., Penk, S. R., & Soto, J. S. V. (2021). Ten simple rules for tackling your first mathematical models: A guide for graduate students by graduate students. PLOS Computational Biology, 17(1), e1008539.](https://doi.org/10.1371/journal.pcbi.1008539)\n-   [Mishra, S., Fisman, D. N., & Boily, M.-C. (2011). The ABC of terms used in mathematical models of infectious diseases. Journal of Epidemiology & Community Health, 65(1), 87–94.](https://jech.bmj.com/content/65/1/87)\n\n---\n\n-   [James, L. P., Salomon, J. A., Buckee, C. O., & Menzies, N. A. (2021). The Use and Misuse of Mathematical Modeling for Infectious Disease Policymaking: Lessons for the COVID-19 Pandemic. 41(4), 379–385.](https://doi.org/10.1177/0272989X21990391)\n-   [Holmdah, I., & Buckee, C. (2020). Wrong but useful—What COVID-19 epidemiologic models can and cannot tell us. New England Journal of Medicine.](https://doi.org/10.1056/nejmp2009027)\n-   [Metcalf, C. J. E. E., Edmunds, W. J., & Lessler, J. (2015). Six challenges in modelling for public health policy. Epidemics, 10(2015), 93–96.](https://doi.org/10.1016/j.epidem.2014.08.008)\n-   [Roberts, M., Andreasen, V., Lloyd, A., & Pellis, L. (2015). Nine challenges for deterministic epidemic models. Epidemics, 10(2015), 49–53.](https://doi.org/10.1016/j.epidem.2014.09.006)\n\n---\n\n### Deriving and Interpreting R0\n\n-   [Jones, J. H. (2011). Notes On R0. Building, 1–19.](https://web.stanford.edu/~jhj1/teachingdocs/Jones-on-R0.pdf)\n-   [Diekmann, O., Heesterbeek, J. A. P., & Metz, J. A. J. (1990). On the definition and the computation of the basic reproduction ratio R0 in models for infectious diseases in heterogeneous populations. Journal of Mathematical Biology, 28(4), 365–382.](https://doi.org/10.1007/BF00178324)\n-   [Diekmann, O., Heesterbeek, J. A. P., & Roberts, M. G. (2010). The construction of next-generation matrices for compartmental epidemic models. Journal of the Royal Society Interface, 7(47), 873–885.](https://doi.org/10.1098/rsif.2009.0386)\n\n---\n\n### References\n\n::: {#refs}\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}