{
  "hash": "73740834690643deb233764220a513c7",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Introduction to Infectious Disease Modelling\"\nauthor:\n  - name: \"James Mba Azam, PhD\"\n    orcid: 0000-0001-5782-7330\n    email: james.azam@lshtm.ac.uk\n    affiliation: \n      - name: Epiverse-TRACE Initiative, London School of Hygiene and Tropical Medicine, UK\n        city: London, United Kingdom\ndate: \"last-modified\"\nexecute:\n  echo: true\n  freeze: auto\n# format:\n#   beamer:\n#     navigation: horizontal\n#     theme: metropolis\n    # institute: Epiverse-TRACE Initiative, London School of Hygiene and Tropical Medicine, UK\n    # orcid: 0000-0001-5782-7330\n    # email: james.azam@lshtm.ac.uk\nformat:\n  revealjs:\n    theme: [solarized]\n    slide-number: true\n    scrollable: true\n    chalkboard: true\n    toc: true\n    toc-depth: 1\ntransition: fade\nlightbox: true\nprogress: true\ncode-copy: true\n# revealjs-plugins:\n#   - revealjs-text-resizer\nbibliography: references.bib\nlink-citations: true\nengine: knitr\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n# An overview of infectious diseases\n\n\n## What are infectious diseases\n\n![](images/disease_definition.png){fig-cap=\"Definition of a disease according to the Merriam Webster dictionary\" fig-align=\"center\"}\n\n------------------------------------------------------------------------\n\n::::: columns\n::: {.column width=\"45%\"}\n![A 3D graphical representation of Rotavirus virions.](images/rotavirus.jpeg)\n:::\n\n::: {.column width=\"55%\"}\nDiseases can be classified according to:\n\n-   [Cause]{style=\"color:tomato\"} (e.g., infectious, non-infectious)\n-   [Duration]{style=\"color:tomato\"} (e.g., acute, chronic)\n-   [Mode of transmission]{style=\"color:tomato\"} (direct or indirect)\n-   [Impact]{style=\"color:tomato\"} on the host (e.g., fatal, non-fatal)\n:::\n:::::\n\n------------------------------------------------------------------------\n\nNote that these classifications are not mutually exclusive. Hence, a disease can be classified under more than one category at a time.\n\n------------------------------------------------------------------------\n\n## How are infectious diseases controlled? {#sec-control-measures}\n\n-   In general, infectious disease control aims to reduce disease transmission.\n-   The type of control used depends on the disease and its characteristics.\n-   Broadly, there are two main types of control measures:\n    -   Pharmaceutical interventions (PIs)\n    -   Non-pharmaceutical interventions (NPIs)\n\n------------------------------------------------------------------------\n\n### Pharmaceutical interventions (PIs)\n\n-   Pharmaceutical Interventions are medical interventions that target the pathogen or the host.\n\n-   Examples:\n\n    -   Vaccines,\n    -   Antiviral drugs, and\n    -   Antibiotics.\n\n------------------------------------------------------------------------\n\n#### Vaccination {#sec-vaccination}\n\n::::: columns\n::: {.column width=\"40%\"}\n![](images/vaccine.jpeg)\n:::\n\n::: {.column width=\"60%\"}\n-   Activates the host's immune system to produce antibodies against the pathogen.\n-   Generally applied to reduce the risk of infection and disease.\n-   The most effective way to prevent infectious diseases.\n:::\n:::::\n\n------------------------------------------------------------------------\n\n##### Challenges with vaccination\n\n-   Take time to develop for new pathogens\n-   Never 100% effective and limited duration of protection\n-   Adverse side effects\n-   Some individuals cannot be vaccinated or refuce vaccination\n-   Some pathogens mutate rapidly (e.g., influenza virus)\n-   Logistical challenges (e.g., cold chain requirements)\n\n------------------------------------------------------------------------\n\n### Non-pharmaceutical interventions (NPIs) {#sec-npi}\n\n::::: columns\n::: {.column width=\"50%\"}\n![](images/mask.jpeg){width=\"70%\"}\n\n![](images/screening.jpeg){width=\"70%\"}\n:::\n\n::: {.column width=\"50%\"}\n-   Non-pharmaceutical interventions are measures that do not involve medical interventions.\n\n-   Examples:\n\n    -   Quarantine,\n    -   Physical/social distancing, and\n    -   Mask-wearing.\n:::\n:::::\n\n------------------------------------------------------------------------\n\n#### Quarantine\n\n-   *Isolation of individuals who may have been exposed to a contagious disease*.\n-   Advantage is that it's simple and its effectiveness does not depend on the disease.\n-   Disadvantages include:\n    -   Infringement on individual rights\n    -   Can be difficult to enforce\n    -   Can be costly\n    -   Can lead to social stigma\n\n------------------------------------------------------------------------\n\n#### Contact tracing\n\n-   Contact tracing is used to identify exposed individuals, i.e., individuals who might been in contact with an infected/infectious individual.\n-   It involves identifying, assessing, and managing people who have been exposed to a contagious disease to prevent further transmission.\n-   It is a critical component of infectious disease surveillance and is often used in combination with other control measures.\n\n------------------------------------------------------------------------\n\n::: {.callout-caution collapse=\"true\" icon=\"false\"}\n### Discussion\n\n-   How can we quantify the impact of a control measure?\n:::\n\n------------------------------------------------------------------------\n\n::: {.fragment style=\"font-size: 450%\"}\nAny Questions?\n:::\n\n\n\n# Infectious disease models\n\n\n## What are infectious disease models?\n\n-   [*Models*]{style=\"color:tomato;\"} generally refer to conceptual representations of an object or system.\n-   [*Mathematical models*]{style=\"color:tomato;\"} use mathematics to describe the system. For example, the famous $E = mc^2$ is a mathematical model that describes the relationship between mass and energy.\n-   [*Infectious disease models*]{style=\"color:tomato;\"} use mathematics and/or statistics to represent dynamics/spread of infectious diseases.\n\n------------------------------------------------------------------------\n\n-   Mathematical models can be used to link the [biological process]{style=\"color:tomato\"} of disease transmission and the [emergent dynamics]{style=\"color:tomato\"} of infection at the [population level]{style=\"color:tomato\"}.\n-   Models require making some [assumptions and abstractions]{style=\"color:tomato\"}.\n\n------------------------------------------------------------------------\n\n::::: columns\n::: {.column width=\"60%\"}\n-   By definition, [\"all models are wrong, but some are useful\"]{style=\"color:tomato\"} [@Box1979].\n    -   Good enough models are those that capture the [essential features]{style=\"color:tomato\"} of the system being studied.\n:::\n\n::: {.column width=\"40%\"}\n![George Box](images/GeorgeEPBox.jpeg)\n:::\n:::::\n\n------------------------------------------------------------------------\n\n::: {.callout-caution collapse=\"true\" icon=\"false\"}\n### Discussion\n\n-   What makes models \"wrong\" by definition?:\n:::\n\n------------------------------------------------------------------------\n\n-   What makes models \"wrong\" by definition?:\n    -   Models simplify reality\n    -   They cannot fully capture all the complexities of the system being studied.\n\n------------------------------------------------------------------------\n\n## Factors that influence model formulation/choice\n\n-   [Accuracy]{style=\"color:tomato; font-weight:bold;\"}: how well does the model to reproduce observed data and predict future outcomes?\n-   [Transparency]{style=\"color:tomato; font-weight:bold;\"}: is it easy to understand and interpret the model and its outputs?\n    -   This is affected by the model's complexity\n-   [Flexibility]{style=\"color:tomato; font-weight:bold;\"}: the ability of the model to be adapted to different scenarios.\n    -   For example, can the model be easily modified to account for new data or changing conditions?\n\n::: notes\nThese will be touched on in the scenario modelling lectures.\n:::\n\n------------------------------------------------------------------------\n\n## What are models used for?\n\n-   Generally, models can be used to [predict]{style=\"color:tomato; font-weight:bold;\"} and [understand/explain]{style=\"color:tomato; font-weight:bold;\"} the dynamics of infectious diseases.\n\n::: {.callout-important icon=\"false\"}\n### Discussion\n\nHow are these two uses impacted by accuracy, transparency, and flexibility? That is, which of these factors is more important for each use?\n:::\n\n------------------------------------------------------------------------\n\n### Prediction of the future course\n\n::::: columns\n::: {.column width=\"40%\"}\n-   Must be [accurate]{style=\"color:tomato;\"}.\n-   \"But the estimate proved to be off. Way, way off. Like, 65 times worse than what ended up happening.\"\n:::\n\n::: {.column width=\"60%\"}\n![](images/wrong_ebola_deaths_estimate.png){fig-cap=\"[CDC’s top modeler courts controversy with disease estimate](https://apnews.com/domestic-news-domestic-news-fbb4fc8921d54201a1c5ca91e5b601f5)\"}\n:::\n:::::\n\n------------------------------------------------------------------------\n\n### Understanding or explaining disease dynamics\n\n-   Models can be used to [understand how a disease spreads]{style=\"color:tomato\"} and how its spread can be [controlled]{style=\"color:tomato\"}.\n-   The insights gained from models can be used to:\n    -   [inform]{style=\"color:blue\"} public health policy and interventions.\n    -   [design]{style=\"color:blue\"} interventions to control the spread of the disease, for example, randomised controlled trials.\n    -   [collect]{style=\"color:blue\"} new data.\n    -   [build]{style=\"color:blue\"} predictive models.\n\n------------------------------------------------------------------------\n\n### Some key milestones in infectious disease modelling\n\n![](images/model_milestones.png){fig-cap=\"Milestones in mathematical modeling and modeling to inform public policy. Source: [Lesslar et al., 2016](10.1093/aje/kww021)\"}\n\n------------------------------------------------------------------------\n\n## Limitations of infectious disease models\n\n-   Host behaviour is often difficult to predict.\n-   The pathogen often has known/unknown characteristics that are difficult to capture.\n-   Data is often not available or is of poor quality.\n\n------------------------------------------------------------------------\n\n## Summary\n\n-   Models:\n    -   Simplify reality and allow us to understand complex systems.\\\n    -   [Simplifications of reality]{style=\"color:tomato\"} and do not capture all the [complexities]{style=\"color:tomato\"} of the system being studied.\n    -   Only as good as the [data]{style=\"color:tomato\"} used to calibrate them.\n    -   Sensitive to the [assumptions]{style=\"color:tomato\"} made during their formulation.\n    -   [Computationally expensive]{style=\"color:tomato\"} and require a lot of data to run.\n    -   [Difficult to interpret]{style=\"color:tomato\"} and communicate to non-experts.\n\n------------------------------------------------------------------------\n\n::: {.fragment style=\"font-size: 450%\"}\nAny Questions?\n:::\n\n\n\n# Types of infectious disease models\n\n\n## Overview of infectious disease model types\n\n-   Infectious disease models can be classified in several ways:\n    -   [Mathematical approach]{style=\"color:tomato; font-weight:bold;\"}: mechanistic vs. phenomenological\n    -   [Randomness]{style=\"color:tomato; font-weight:bold;\"}: deterministic vs. stochastic\n    -   [Time]{style=\"color:tomato; font-weight:bold;\"}: discrete vs. continuous\n    -   [Space]{style=\"color:tomato; font-weight:bold;\"}: spatial vs. non-spatial\n    -   [Population structure]{style=\"color:tomato; font-weight:bold;\"}: homogeneous vs. heterogeneous\n\n------------------------------------------------------------------------\n\n-   The choice of model type depends on:\n    -   [Research question]{style=\"color:tomato\"} being addressed\n    -   [Available data]{style=\"color:tomato\"} and its quality\n    -   [Computational resources]{style=\"color:tomato\"} and time constraints\n    -   [Expertise]{style=\"color:tomato\"} of the modelling team\n    -   [Intended audience]{style=\"color:tomato\"} and use case\n\n------------------------------------------------------------------------\n\n## Mathematical approach: Mechanistic vs. Phenomenological\n\n::::: columns\n::: {.column width=\"50%\"}\n### Mechanistic models\n\n-   Model the [underlying biological processes]{style=\"color:blue\"} of disease transmission\n-   Include explicit representations of:\n    -   Host-pathogen interactions\n    -   Disease natural history\n    -   Population mixing patterns\n:::\n\n::: {.column width=\"50%\"}\n### Phenomenological models\n\n-   Focus on [describing patterns]{style=\"color:orange\"} in data\n-   Do not explicitly model biological mechanisms\n-   Often statistical in nature\n:::\n:::::\n\n## Mathematical approach: Mechanistic vs. Phenomenological\n\n::::: columns\n::: {.column width=\"50%\"}\n### Mechanistic models\n\n-   Examples: SIR, SEIR, agent-based models\n:::\n\n::: {.column width=\"50%\"}\n### Phenomenological models\n\n-   Examples: curve fitting, time series models, regression models\n:::\n:::::\n\n------------------------------------------------------------------------\n\n### Mechanistic models: Advantages and disadvantages\n\n::::: columns\n::: {.column width=\"50%\"}\n**Advantages:**\n\n\\- Can provide [biological insights]{style=\"color:green\"}\n\n\\- Allow testing of [intervention scenarios]{style=\"color:green\"}\n\n\\-   Can extrapolate beyond observed data\n\n\\- Parameters often have [biological interpretation]{style=\"color:green\"}\n:::\n\n::: {.column width=\"50%\"}\n**Disadvantages:**\n\n\\- Require [detailed knowledge]{style=\"color:red\"} of biological processes\n\n\\- Can be [complex]{style=\"color:red\"} to develop and validate\n\n\\- May require [extensive data]{style=\"color:red\"} for parameterization\n\n\\- Computationally [expensive]{style=\"color:red\"}\n:::\n:::::\n\n------------------------------------------------------------------------\n\n### Phenomenological models: Advantages and disadvantages\n\n::::: columns\n::: {.column width=\"50%\"}\n**Advantages:**\n\n\\- [Simpler]{style=\"color:green\"} to develop and implement\n\n\\- Good for [short-term predictions]{style=\"color:green\"}\n\n\\- Require [less detailed data]{style=\"color:green\"}\n\n\\- Computationally [efficient]{style=\"color:green\"}\n:::\n\n::: {.column width=\"50%\"}\n**Disadvantages:**\n\n\\- Limited [biological insight]{style=\"color:red\"}\n\n\\- Poor [extrapolation]{style=\"color:red\"} capabilities\n\n\\- Cannot easily test [interventions]{style=\"color:red\"}\n\n\\- May not capture [underlying dynamics]{style=\"color:red\"}\n:::\n:::::\n\n------------------------------------------------------------------------\n\n::: {.callout-important icon=\"false\"}\n### Discussion\n\nThink of a recent epidemic (e.g., COVID-19, Mpox, Ebola). Which type of model would be more appropriate for:\n\n1\\. Understanding transmission mechanisms?\n\n2\\. Forecasting case numbers next week?\n\n3\\. Evaluating vaccination strategies?\n:::\n\n------------------------------------------------------------------------\n\n## Deterministic vs. Stochastic models\n\n::::: columns\n::: {.column width=\"50%\"}\n### Deterministic models\n\n-   [Same input]{style=\"color:blue\"} always produces [same output]{style=\"color:blue\"}\n-   Use differential equations or difference equations\n-   Represent [average behavior]{style=\"color:blue\"} of the system\n-   Examples: classical SIR/SEIR models\n:::\n\n::: {.column width=\"50%\"}\n### Stochastic models\n\n-   Include [random variation]{style=\"color:orange\"}\n-   Same input can produce [different outputs]{style=\"color:orange\"}\n-   Account for uncertainty and chance events\n-   Examples: stochastic SIR, branching processes\n:::\n:::::\n\n------------------------------------------------------------------------\n\n### When to use deterministic vs. stochastic models?\n\n::::: columns\n::: {.column width=\"50%\"}\n### Deterministic models\n\n**Best for:**\n\n\\- [Large populations]{style=\"color:green\"} (\\>10,000)\n\n\\- Understanding [general trends]{style=\"color:green\"}\n\n\\- [Parameter estimation]{style=\"color:green\"}\n\n\\- When computational [efficiency]{style=\"color:green\"} is important\n:::\n\n::: {.column width=\"50%\"}\n### Stochastic models\n\n**Best for:**\n\n\\- [Small populations]{style=\"color:green\"} (\\<1,000)\n\n\\- [Early epidemic phases]{style=\"color:green\"}\n\n\\- [Uncertainty quantification]{style=\"color:green\"}\n\n\\- [Extinction events]{style=\"color:green\"}\n:::\n:::::\n\n------------------------------------------------------------------------\n\n### When to use deterministic vs. stochastic models?\n\n::::: columns\n::: {.column width=\"50%\"}\n### Deterministic models\n\n**Limitations:**\n\n\\- Cannot capture [fade-out]{style=\"color:red\"} in small populations\n\n\\- No [uncertainty quantification]{style=\"color:red\"}\n:::\n\n::: {.column width=\"50%\"}\n### Stochastic models\n\n**Limitations:**\n\n\\- Computationally [intensive]{style=\"color:red\"}\n\n\\- Require [multiple runs]{style=\"color:red\"}\n\n\\- More complex to [implement]{style=\"color:red\"}\n:::\n:::::\n\n## Time: Discrete vs. Continuous models\n\n::::: columns\n::: {.column width=\"50%\"}\n### Discrete time models\n\n-   Time progresses in [fixed steps]{style=\"color:blue\"} (hours, days, weeks)\n-   Use *difference equations*\n-   Natural for [surveillance data]{style=\"color:blue\"}\n:::\n\n::: {.column width=\"50%\"}\n### Continuous time models\n\n-   Time flows [continuously]{style=\"color:orange\"}\n-   Use *differential equations*\n-   Better for [theoretical analysis]{style=\"color:orange\"}\n:::\n:::::\n\n------------------------------------------------------------------------\n\n## Time: Discrete vs. Continuous models\n\n::::: columns\n::: {.column width=\"50%\"}\n### Discrete time models\n\n-   Examples: daily case counts, weekly reports\n\n$$S_{t+1} = S_t - \\beta S_t I_t$$\n:::\n\n::: {.column width=\"50%\"}\n### Continuous time models\n\n-   Examples: classical epidemic models\n\n$$\\frac{dS}{dt} = -\\beta S I$$\n:::\n:::::\n\n------------------------------------------------------------------------\n\n### Time scale considerations\n\n-   [Disease natural history]{style=\"color:tomato\"}:\n    -   Acute diseases (days) → *discrete time* often sufficient\n    -   Chronic diseases (years) → *continuous time* may be better\n\n------------------------------------------------------------------------\n\n-   [Data availability]{style=\"color:tomato\"}:\n    -   Daily surveillance data → *discrete time* natural\n    -   Continuous monitoring → either approach possible\n\n------------------------------------------------------------------------\n\n-   [Research question]{style=\"color:tomato\"}:\n    -   Policy timing → *discrete time* practical\n    -   Theoretical insights → *continuous time* elegant\n\n## Spatial considerations\n\n::::: columns\n::: {.column width=\"50%\"}\n### Non-spatial (well-mixed) models\n\n-   Assume [homogeneous mixing]{style=\"color:blue\"}\n-   All individuals have [equal contact]{style=\"color:blue\"} probability\n-   Simpler to analyze and implement\n-   Good for [small, homogeneous]{style=\"color:blue\"} populations\n:::\n\n::: {.column width=\"50%\"}\n### Spatial models\n\n-   Account for [geographic structure]{style=\"color:orange\"}\n-   Include [movement patterns]{style=\"color:orange\"}\n-   Can model [local transmission]{style=\"color:orange\"}\n-   Important for [large-scale]{style=\"color:orange\"} epidemics\n:::\n:::::\n\n------------------------------------------------------------------------\n\n::::: columns\n::: {.column width=\"50%\"}\n### Non-spatial (well-mixed) models\n\n-   Simpler to analyze and implement\n-   Good for [small, homogeneous]{style=\"color:blue\"} populations\n:::\n\n::: {.column width=\"50%\"}\n### Spatial models\n\n-   Can model [local transmission]{style=\"color:orange\"}\n-   Important for [large-scale]{style=\"color:orange\"} epidemics\n:::\n:::::\n\n------------------------------------------------------------------------\n\n-   [**Metapopulation models**]{style=\"color:tomato\"}:\n    -   Discrete patches connected by migration\n    -   Good for cities/regions connected by travel\n    \n------------------------------------------------------------------------\n\n-   [**Network models**]{style=\"color:tomato\"}:\n    -   Individuals as nodes, contacts as edges\n    -   Can represent social or transportation networks\n\n------------------------------------------------------------------------\n\n-   [**Continuous space models**]{style=\"color:tomato\"}:\n    -   Individuals distributed in continuous space\n    -   Include local transmission kernels\n\n------------------------------------------------------------------------\n\n## Population structure: Homogeneous vs. Heterogeneous\n\n::::: columns\n::: {.column width=\"50%\"}\n### Homogeneous models\n\n-   All individuals are [identical]{style=\"color:blue\"}\n-   Same [contact rates]{style=\"color:blue\"}\n-   Same [susceptibility]{style=\"color:blue\"}\n-   Simpler to analyze\n:::\n\n::: {.column width=\"50%\"}\n### Heterogeneous models\n\n-   Account for [individual differences]{style=\"color:orange\"}:\n    -   Age groups\n    -   Risk behaviors\n    -   Vaccination status\n    -   Geographic location\n-   More realistic but complex\n:::\n:::::\n\n------------------------------------------------------------------------\n\n### Common types of heterogeneity\n\n-   [**Age structure**]{style=\"color:tomato\"}: Different contact patterns and susceptibility by age\n-   [**Risk groups**]{style=\"color:tomato\"}: High-risk vs. low-risk populations\n-   [**Behavioral differences**]{style=\"color:tomato\"}: Compliance with interventions\n\n------------------------------------------------------------------------\n\n-   [**Immunity status**]{style=\"color:tomato\"}: Vaccinated, previously infected, naive\n-   [**Geographic**]{style=\"color:tomato\"}: Urban vs. rural, different regions\n\n------------------------------------------------------------------------\n\n## Network models\n\n::::: columns\n::: {.column width=\"60%\"}\n-   Represent individuals as [nodes]{style=\"color:tomato\"}\n-   Contacts/relationships as [edges]{style=\"color:tomato\"}\n-   Can capture:\n    -   Social networks\n    -   Sexual networks\n    -   Transportation networks\n    -   Hospital networks\n:::\n\n::: {.column width=\"40%\"}\n![Examples of network models. Source: [Danon et al., 2010](10.1155/2011/284909)](images/network_models.png)\n:::\n:::::\n\n------------------------------------------------------------------------\n\n### Network model advantages\n\n-   Capture [realistic contact patterns]{style=\"color:green\"}\n-   Can model [targeted interventions]{style=\"color:green\"} (e.g., contact tracing)\n-   Account for [superspreading]{style=\"color:green\"} events\n-   Useful for [outbreak investigation]{style=\"color:green\"}\n\n### Network model challenges\n\n-   Require [detailed contact data]{style=\"color:red\"}\n-   Computationally [intensive]{style=\"color:red\"}\n-   Network structure may be [unknown]{style=\"color:red\"} or [time-varying]{style=\"color:red\"}\n\n## Agent-based models (ABMs)\n\n-   Model [individual agents]{style=\"color:tomato\"} and their interactions\n-   Each agent has:\n    -   Individual characteristics\n    -   Behavioral rules\n    -   Interaction patterns\n    \n------------------------------------------------------------------------\n\n## Agent-based models (ABMs)\n\n-   System behavior [emerges]{style=\"color:blue\"} from individual interactions\n-   Very flexible but computationally intensive\n\n------------------------------------------------------------------------\n\n### Agent-based model applications\n\n-   [**Household transmission**]{style=\"color:tomato\"}: Model within-household spread\n-   [**School closures**]{style=\"color:tomato\"}: Impact on different age groups\n-   [**Behavioral responses**]{style=\"color:tomato\"}: How people change behavior during epidemics\n\n------------------------------------------------------------------------\n\n### Agent-based model applications\n\n-   [**Contact tracing**]{style=\"color:tomato\"}: Effectiveness of different strategies\n-   [**Vaccination campaigns**]{style=\"color:tomato\"}: Optimal distribution strategies\n\n------------------------------------------------------------------------\n\n## Model selection framework\n\n::: {.callout-tip icon=\"false\"}\n### Key questions for model selection:\n\n1.  What is your [research question]{style=\"color:tomato\"}?\n2.  What [data]{style=\"color:tomato\"} do you have available?\n3.  What is your [population size]{style=\"color:tomato\"}?\n4.  How important is [spatial structure]{style=\"color:tomato\"}?\n5.  Do you need to model [heterogeneity]{style=\"color:tomato\"}?\n6.  What are your [computational constraints]{style=\"color:tomato\"}?\n7.  What is your [timeline]{style=\"color:tomato\"}?\n:::\n\n------------------------------------------------------------------------\n\n### The modelling for decision-making process\n\n![The modelling process involves balancing realism, tractability, and generality. Source: [Heesterbeek et al, 2015](10.1126/science.aaa4339)](images/modelling_process.png)\n\n------------------------------------------------------------------------\n\n::: {.callout-important icon=\"false\"}\n### Discussion\n\nConsider modeling influenza transmission in a university:\n\n1.  What type of model would you choose and why?\n2.  What heterogeneities would be important to include?\n3.  Would you use a spatial model?\n4.  Deterministic or stochastic?\n:::\n\n------------------------------------------------------------------------\n\n## Summary: Choosing the right model type\n\n-   [**Start simple**]{style=\"color:tomato\"}: Begin with the simplest model that addresses your question\n-   [**Add complexity gradually**]{style=\"color:tomato\"}: Only when justified by data or research needs\n-   [**Consider your audience**]{style=\"color:tomato\"}: Policymakers may prefer simpler, more interpretable models\n-   [**Validate carefully**]{style=\"color:tomato\"}: More complex models require more validation\n-   [**Document assumptions**]{style=\"color:tomato\"}: Be explicit about model limitations\n\n------------------------------------------------------------------------\n\n### Common model progression\n\n1.  [**Homogeneous compartmental**]{style=\"color:blue\"} (SIR/SEIR) → understanding basic dynamics\n2.  [**Add heterogeneity**]{style=\"color:blue\"} → age groups, risk groups\n3.  [**Add spatial structure**]{style=\"color:blue\"} → metapopulation, networks\n4.  [**Add stochasticity**]{style=\"color:blue\"} → uncertainty quantification\n5.  [**Individual-based**]{style=\"color:blue\"} → complex behaviors, interventions\n\n------------------------------------------------------------------------\n\n### Next: Deep dive into compartmental models\n\n-   Now that we understand the landscape of infectious disease models...\n-   We'll focus on [**compartmental models**]{style=\"color:tomato\"} - the most widely used approach\n-   Starting with the fundamental concepts and building up to specific models (SIR, SEIR)\n-   These form the foundation for most infectious disease modelling\n\n------------------------------------------------------------------------\n\n::: {.fragment style=\"font-size: 450%\"}\nAny Questions?\n:::\n\n\n\n# Introduction to compartmental models\n\n\n## What are compartmental models?\n\n-   Compartmental models:\n    -   divide populations into compartments (or groups) based on the individual's infection status and track them through time [@Blackwood2018a].\n    -   are mechanistic, meaning they describe processes such the interaction between hosts, biological processes of pathogen, host immune response, and so forth.\n\n------------------------------------------------------------------------\n\nCompartmental models are different from statistical models, which are used to describe the relationship between variables.\n\n------------------------------------------------------------------------\n\n-   Individuals in a compartment:\n    -   are assumed to have the same features (disease state, age, location, etc)\n    -   can only be in one compartment at a time.\n    -   move between compartments based on defined transition rates.\n\n------------------------------------------------------------------------\n\n::::: columns\n::: {.column width=\"60%\"}\n-   Common compartments:\n    -   Susceptible (S) - hosts are not infected but can be infected\n    -   Infected (I) - hosts are infected (and can infect others)\n    -   Removed (R) - hosts are no longer infected and cannot be re-infected\n:::\n\n::: {.column width=\"40%\"}\n![Infection timeline illustrating how a pathogen in a host interacts with the host's immune system (Source: Modelling Infectious Diseases of Humans and Animals)](images/infection_timeline.png)\n:::\n:::::\n\n------------------------------------------------------------------------\n\n-   Other compartments can be added to the model to account for important events or processes (e.g., exposed, recovered, vaccinated, etc.)\n\n-   It is, however, important to keep the model simple, less computationally intensive, and interpretable.\n\n------------------------------------------------------------------------\n\n-   Compartmental models either have *discrete* or *continuous* time scales:\n    -   [Discrete time scales]{style=\"color:tomato;\"}: time is divided into discrete intervals (e.g., days, weeks, months).\n    -   [Continuous time scales]{style=\"color:tomato;\"}: time is continuous and the model is described using differential equations.\n\n------------------------------------------------------------------------\n\n-   Compartmental models can be *deterministic* or *stochastic*:\n    -   [Deterministic]{style=\"color:tomato;\"} models always return the same output for the same input.\n    -   [Stochastic]{style=\"color:tomato;\"} models account for randomness in the system and model output always varies. Hence, they are often run multiple times to get an average output.\n\n------------------------------------------------------------------------\n\n-   The choice of model type depends on:\n    -   the research [question]{style=\"color:tomato\"},\n    -   [data]{style=\"color:tomato\"} availability,\n    -   [computational resources]{style=\"color:tomato\"},\n    -   modeller [skillset]{style=\"color:tomato\"}.\n-   In this introduction, we will focus on [deterministic compartmental models with continuous time scales]{style=\"color:tomato;\"}.\n\n------------------------------------------------------------------------\n\n-   Now, back to the models, we are going to consider infections that either confer immunity after recovery or not.\n-   The simplest compartmental models for capturing this is the SIR model.\n\n------------------------------------------------------------------------\n\n::: {.fragment style=\"font-size: 450%\"}\nAny Questions?\n:::\n\n\n\n## The Susceptible-Infected-Recovered (SIR) model\n\n\n![](/images/model_diagrams/model_diagrams.001.jpeg){width=\"40%\" fig-align=\"center\"}\n\nThis model groups individuals into three *disease states*:\n\n-   [Susceptible (S)]{style=\"color:green;\"}: not infected but can be.\n\n-   [Infected (I)]{style=\"color:tomato;\"}: infected & infectious.\n\n-   [Recovered/removed (R)]{style=\"color:blue;\"}: recovered & immune.\n\n------------------------------------------------------------------------\n\n### How do individuals move between compartments?\n\n#### Process 1: Transmission\n\n![](images/model_diagrams/model_diagrams.002.jpeg){width=\"70%\"}\n\n[What drives transmission?]{style=\"color:red;\"}\n\n------------------------------------------------------------------------\n\n-   Transmission is driven by several factors, including:\n    -   Disease prevalence, [$I$]{style=\"color:blue;\"}, i.e., number of infected individuals at the time.\n    -   The number of contacts, [$C$]{style=\"color:blue;\"}, susceptible individuals have with infected individual.\n    -   The probability, [$p$]{style=\"color:blue;\"}, a susceptible individual will become infected when they contact an infected individual.\n\n------------------------------------------------------------------------\n\n![](images/model_diagrams/model_diagrams.002.jpeg){width=\"70%\"}\n\nThe transmission term is often defined through the [force of infection (FOI), $\\lambda$]{style=\"color:tomato;\"}.\n\n------------------------------------------------------------------------\n\n### A tour of the force of infection (FOI)\n\n-   FOI, $\\lambda$, is the [per capita rate]{style=\"color:tomato;\"} at which susceptible individuals become infected.\n\n::: {.callout-note collapse=\"true\" icon=\"false\"}\n\"Per capita\" means the rate of an event occurring per individual in the population per unit of time.\n:::\n\n-   Given the rate per individual per time, FOI, the rate at which new infecteds are generated is given by [$\\lambda \\times S$]{style=\"color:blue;\"}, where $S$ is the number of susceptible individuals.\n\n------------------------------------------------------------------------\n\n-   The force of infection is made up of the probabilities/rates that:\n    -   contacts happen, [$c$]{style=\"color:blue\"},\n    -   a given contact is with an infected individual, [$p$]{style=\"color:blue\"}, and\n    -   a contact results in successful transmission, [$v$]{style=\"color:blue\"}.\n\n------------------------------------------------------------------------\n\n-   The FOI can be formulated in two ways, depending on how the contact rate is expected to change with the population size:\n    -   Frequency-dependent/mass action transmission\n    -   Density-dependent transmission\n\n------------------------------------------------------------------------\n\n#### Frequency-dependent/mass action transmission\n\nThe rate of contact between individuals is constant irrespective of the population density, [$\\dfrac{N}{A}$]{style=\"color:blue\"}, where [$N$]{style=\"color:blue\"} is the population size and [$A$]{style=\"color:blue\"} is the area occupied by the population.\n\n------------------------------------------------------------------------\n\n-   Recall that transmission also depends on the probability of contact with an infected host, [$p$]{style=\"color:blue\"}, which is assumed to be [$\\dfrac{I}{N}$]{style=\"color:blue\"}.\n\n-   Hence, the frequency-dependent mass action is given by [$\\lambda = \\beta \\times \\dfrac{I}{N}$]{style=\"color:blue\"}, where [$\\beta$]{style=\"color:blue\"} is the transmission rate.\n\n------------------------------------------------------------------------\n\n::: {.callout-caution collapse=\"true\" icon=\"false\"}\n#### Question\n\nWhy does the frequency-dependent transmission contain [$\\dfrac{1}{N}$]{style=\"color:blue\"} if it does not depend on the population density?\n:::\n\n------------------------------------------------------------------------\n\n-   Assume that the rate of new infections is given by [$\\dfrac{dI}{dt} = S \\times c \\times p \\times v$]{style=\"color:blue\"} where [$S$]{style=\"color:blue\"} is the number of susceptible hosts, [$c$]{style=\"color:blue\"} is the contact rate, and [$p$]{style=\"color:blue\"} is the probability of contact with an infected host, and [$v$]{style=\"color:blue\"} is the probability of transmission per contact.\n\n------------------------------------------------------------------------\n\n-   [$p$]{style=\"color:blue\"} is usually assumed to be the disease prevalence, [$\\dfrac{I}{N}$]{style=\"color:blue\"}.\n\n-   Hence, the rate of new infections, [$\\dfrac{dI}{dt} = S \\times c \\times \\dfrac{I}{N}  \\times v$]{style=\"color:blue;\"}.\n\n------------------------------------------------------------------------\n\n-   In frequency dependent transmission, the contact rate [$c$]{style=\"color:blue\"} is also assumed to be constant, say [$c = \\eta$]{style=\"color:blue\"} irrespective of population density, [$\\dfrac{N}{A}$]{style=\"color:blue\"}, where [$N$]{style=\"color:blue\"} is the population size and [$A$]{style=\"color:blue\"} is the area occupied by the population.\n-   Hence, [$\\dfrac{dI}{dt} = S \\times \\eta \\times v \\times \\dfrac{I}{N}$]{style=\"color:blue\"}\n-   Therefore, [$\\dfrac{dI}{dt} = \\beta S \\times \\dfrac{I}{N}$]{style=\"color:blue\"}, where [$\\beta = \\eta \\times v$]{style=\"color:blue\"}, and [$\\lambda = \\beta \\times \\dfrac{I}{N}$]{style=\"color:blue\"}.\n\n------------------------------------------------------------------------\n\n-   [*Frequency-dependent/mass action transmission*]{style=\"color:tomato;\"} is often used to model sexually-transmitted diseases and diseases with heterogeneity in contact rates.\n-   Sexual transmission in this case does not depend on how many infected individuals are in the population.\n\n------------------------------------------------------------------------\n\n#### Density dependent transmission\n\n-   The rate of contact between individuals depends on the population density, [$\\dfrac{N}{A}$]{style=\"color:blue\"}.\n\n-   Transmission also depends on [$p$]{style=\"color:blue\"} - the probability that a given contact is with an infected individual, often taken to be [$\\dfrac{I}{N}$]{style=\"color:blue\"}.\n\n------------------------------------------------------------------------\n\n-   The density-dependent transmission is therefore given as [$\\lambda = \\beta \\times \\dfrac{I}{A}$]{style=\"color:blue\"}.\n\n-   Here, because transmission increases with the density of infected individuals, it is called density-dependent transmission.\n\n::: {.callout-note collapse=\"true\" icon=\"false\"}\n-   Notice that [$\\lambda = \\beta \\times \\dfrac{I}{N} \\times \\dfrac{N}{A}$]{style=\"color:blue\"} and the $N's$ cancel out.\n\n-   [$A$]{style=\"color:blue\"} is often ignored.\n:::\n\n------------------------------------------------------------------------\n\n-   [*Density dependent transmission*]{style=\"color:tomato;\"} can be used to model airborne and directly transmitted diseases, for example, measles.\n\n------------------------------------------------------------------------\n\n::: {.callout-caution collapse=\"true\" icon=\"false\"}\n#### Density-dependent vs frequency dependent transmission\n\nThis is one of the most confused and debated concepts in disease modelling. Several studies have attempted to clarify it, including the brilliant work by @begon2002clarification. Most of the clarifications provided here are based on this paper.\n:::\n\n-   We will only use the [density-dependent]{style=\"color:tomato;\"} formulation in this course.\n\n------------------------------------------------------------------------\n\n![](images/model_diagrams/model_diagrams.003.jpeg)\n\n------------------------------------------------------------------------\n\n#### Process 2: Recovery\n\n![](images/model_diagrams/model_diagrams.005.jpeg){width=\"60%\" fig-align=\"center\"}\n\n[Recovery]{style=\"color:tomato;\"}, governed by the recovery rate, $\\gamma$ (rate at which infected individuals recover and become immune).\n\n------------------------------------------------------------------------\n\n##### Some notes on the recovery process\n\n-   If the duration of infection is [$\\dfrac{1}{\\gamma}$]{style=\"color:blue\"}, then the rate at which infected individuals recover is [$\\gamma$]{style=\"color:blue\"}.\n\n-   The average infectious period is often [estimated from epidemiological data]{style=\"color:tomato;\"}.\n\n::: {.callout-note collapse=\"true\" icon=\"false\"}\nYou will learn about parameter estimation in the model fitting and calibration lectures.\n:::\n\n------------------------------------------------------------------------\n\n![Source: @anderson1982directly](images/epi_parameters.png)\n\n------------------------------------------------------------------------\n\n### Putting it all together\n\n![An SIR model with transmission rate, $\\beta$, and recovery rate, $\\gamma$.](images/model_diagrams/model_diagrams.006.jpeg){width=\"80%\"}\n\n------------------------------------------------------------------------\n\n### Formulating the model equations\n\n[Continuous time compartmental]{style=\"color:tomato;\"} models are formulated using [differential equations]{style=\"color:tomato;\"} that describe the change in the number of individuals in each compartment over time.\n\n------------------------------------------------------------------------\n\nThe SIR model can be formulated as:\n\n::::: columns\n::: {.column width=\"50%\"}\n![](images/model_diagrams/model_diagrams.006.jpeg){fig-align=\"center\"}\n:::\n\n::: {.column width=\"50%\"}\n\\begin{align*}\n\\frac{dS}{dt} & = \\dot{S}  = \\color{orange}{-\\beta S I} \\\\\n\\frac{dI}{dt} & = \\dot{I}  = \\color{orange}{\\beta S I} - \\color{blue}{\\gamma I} \\\\\n\\frac{dR}{dt} & = \\dot{R} = \\color{blue}{\\gamma I}\n\\end{align*}\n:::\n:::::\n\nwhere [$\\beta$]{style=\"color:blue;\"} is the transmission rate, and [$\\gamma$]{style=\"color:blue;\"} is the recovery rate.\n\n::: notes\n-   We may or may not use the dot notation to denote the rate of change.\n-   The terms are just **inflows** and **outflows**.\n-   **Pause** for questions and clarifications.\n:::\n\n------------------------------------------------------------------------\n\nThe initial conditions are given by:\n\n\\begin{equation*}\n\\begin{aligned}\nS(0) & = N - 1,\\\\\nI(0) & = 1, \\text{and} \\\\\nR(0) & = 0.\n\\end{aligned}\n\\end{equation*}\n\nwhere $N$ is the total population size.\n\n------------------------------------------------------------------------\n\n::: {.callout-note collapse=\"true\" icon=\"false\"}\n-   We represent the compartments as [population sizes]{style=\"color:tomato;\"}.:\n    -   Some modellers often use [proportions]{style=\"color:tomato;\"} instead of population sizes as a way to remove the dimensions from the equations.\n:::\n\n------------------------------------------------------------------------\n\n### Model assumptions\n\n-   The population is closed: no births, deaths, or migration.\n    -   Implicitly: the epidemic occurs much faster than the time scale of births, deaths, or migration.\n-   Individuals are infectious immediately after infection and remain infectious until they recover.\n\n------------------------------------------------------------------------\n\n-   Mixing is *homogeneous*, i.e., [individuals mix randomly]{style=\"color:tomato;\"}:\n\n-   Individuals have an equal probability of coming into contact with any other individual in the population.\n\n-   Transition rates are constant and do not change over time.\n\n-   Individuals acquire \"lifelong\" immunity after recovery.\n\n::: notes\nThe $R$ compartment is an absorbing state in this model.\n:::\n\n------------------------------------------------------------------------\n\n::: {.callout-caution collapse=\"true\" icon=\"false\"}\n#### Discussion\n\n-   What diseases do you think the SIR model is appropriate for?\n:::\n\n------------------------------------------------------------------------\n\n-   The SIR model is appropriate for diseases that confer immunity after recovery. For example, measles and chicken pox.\n-   Popularised by Kermack and McKendrick in 1927 [@kermack1927contribution]\n    -   A must-read paper for budding infectious disease modellers.\n\n------------------------------------------------------------------------\n\n### What questions can we answer with the SIR model?\n\n-   The SIR model can be used to understand the dynamics of an epidemic:\n    -   How long will the epidemic last?\n    -   How many individuals will be infected (final epidemic size)?\n    -   When will the epidemic reach its peak?\n\n------------------------------------------------------------------------\n\n## Solving the SIR model\n\n-   Compartmental models cannot be solved analytically.\n\n-   We often perform two types of analyses to understand the [long term dynamics]{style=\"color:tomato;\"} of the model:\n\n    -   Qualitative: threshold phenomena and analysis of equilibria (disease-free and endemic).\\\n    -   Numerical simulations.\n\n::: callout-note\n-   For this introductory course, we will use focus on simulation.\n:::\n\n-   But first, let's do some qualitative analysis of the SIR.\n\n------------------------------------------------------------------------\n\n### Threshold phenomena\n\n-   Here, we study the conditions under which an epidemic will [grow or die out]{style=\"color:tomato;\"} using the model equations.\n\n------------------------------------------------------------------------\n\n-   Consider the case where $I(0) = 1$ individual is introduced into a population of size $N$ at time $t = 0$.\n\n-   That means in a completely susceptible population, we have $S(0) = N - 1$ susceptible individuals.\n\n------------------------------------------------------------------------\n\n-   At time 0, the disease will not spread if the rate of change of infections is negative, that is [$\\dfrac{dI}{dt} < 0$]{style=\"color:blue;\"}.\n\n-   Recall from the SIR model that [$\\dfrac{dI}{dt} = \\beta S I - \\gamma I$]{style=\"color:blue;\"}.\n\n-   Let's solve this equation at $t = 0$ by setting $I = 1$, assuming [$\\dfrac{dI}{dt} < 0$]{style=\"color:blue;\"}.\n\n------------------------------------------------------------------------\n\nAt $t = 0$, we have\n\n\\begin{equation*}\n\\frac{dI}{dt} = \\beta S I - \\gamma I < 0 \\end{equation*}\n\nFactor out $I$, and we get\n\n\\begin{equation*}\nI (\\beta S - \\gamma) < 0\n\\end{equation*}\n\n------------------------------------------------------------------------\n\n-   Since at $t=0$$, I > 0$, we have [$S < \\dfrac{\\gamma}{\\beta}$]{style=\"color:blue;\"}.\n\n-   [$\\dfrac{\\gamma}{\\beta}$]{style=\"color:blue;\"} is the relative removal rate.\n\n------------------------------------------------------------------------\n\n-   **Interpretation**:\n\n    -   At $t = 0$, $S$ must be less than $\\dfrac{\\gamma}{\\beta}$ for the epidemic to die out.\n    -   If the rate of removal/recovery is greater than the transmission rate, the epidemic will die out.\n    -   Any infection that cannot transmit to more than one host is going to die out.\n\n------------------------------------------------------------------------\n\nFor the SIR model, the quantity [$\\dfrac{\\beta}{\\gamma}$]{style=\"color:blue\"} is called the [reproduction number, $R0$]{style=\"color:tomato\"} (pronounced \"R naught\" or \"R zero\").\n\n------------------------------------------------------------------------\n\n#### The basic reproduction number, R0\n\n-   The basic reproduction number, [$R0$]{style=\"color:blue\"}, is the average number of secondary infections generated by a [single primary infection]{style=\"color:tomato\"} in a [completely susceptible]{style=\"color:tomato\"} population.\n\n-   The basic reproduction number is a key quantity in infectious disease epidemiology.\n\n------------------------------------------------------------------------\n\n-   It is often represented as a single number or a range of high-low values.\n    -   For example, the $R0$ for measles is popularly known to be $12$ - $18$ [@guerra2017measlesR0].\n\n------------------------------------------------------------------------\n\n-   $R0$ is often used to express the threshold phenomena in infectious disease epidemiology:\n    -   If $R0 > 1$, the epidemic will grow.\n    -   If $R0 < 1$, the epidemic will decline.\n-   A pathogen's $R0$ value is determined by biological characteristics of the pathogen and the host's behaviour.\n\n------------------------------------------------------------------------\n\n-   Conceptually, $R0$ is given by\n\n$$\nR0 \\propto \\dfrac{\\text{Infection}}{\\text{Contact}} \\times \\dfrac{\\text{Contact}}{\\text{Time}} \\times \\dfrac{\\text{Time}}{\\text{Infection}}\n$$\n\n-   $R0$ is unitless and dimensionless.\n\n------------------------------------------------------------------------\n\n### Numerical simulations\n\n-   Numerical simulations can be performed with any programming language.\n\n-   This course focuses on the R programming language because:\n\n    -   It is a popular language for data analysis and statistical computing.\n    -   It has a rich ecosystem of packages for solving differential equations.\n    -   It is free and open-source.\n\n------------------------------------------------------------------------\n\n-   In R, we can use the `{deSolve}` package to solve the differential equations.\n\n-   To solve the model in R with `{deSolve}`, we will always need to define at least three things:\n\n    -   The model equations.\n    -   The initial parameter values.\n    -   The initial conditions (population sizes).\n\n------------------------------------------------------------------------\n\n#### Practicals\n\n-   Let's do a code walk through in R using the script [`sir.Rmd`](https://github.com/jamesmbaazam/mppr_r_practicals/tree/main/model_implementation_practicals).\n\n------------------------------------------------------------------------\n\n::: {.callout-caution collapse=\"true\" icon=\"false\"}\n#### Discussion\n\n-   What happens if we increase or decrease the value of $R0$?\n-   What happens if we increase or decrease the value of the infectious period?\n-   How can we flatten the curve?\n:::\n\n::: notes\n-   We can flatten the curve by reducing the value of $R0$.\n-   In reality, we can reduce $R0$ by implementing control measures such as social distancing, wearing masks, and vaccination.\n-   These control measures reduce the number of contacts between individuals or the probability of infection, which in turn reduces the transmission rate.\n:::\n\n------------------------------------------------------------------------\n\n::: {.fragment style=\"font-size: 450%\"}\nAny Questions?\n:::\n\n\n\n## The Susceptible-Exposed-Infected-Recovered (SEIR) Model\n\n\n![Timeline of infection. Source: Keeling & Rohani, 2008](images/infection_timeline.png)\n\n------------------------------------------------------------------------\n\n::::: columns\n::: {.column width=\"30%\"}\n![The SARS-COV-2 virus](images/corona_virus.jpeg)\n\n![The Ebola virus](images/ebola_virus.jpeg)\n:::\n\n::: {.column width=\"70%\"}\n-   Some diseases have an [latent/exposed period]{style=\"color:tomato;\"} during which individuals are [infected but not yet infectious]{style=\"color:tomato;\"}. Examples include pertussis, COVID-19, and Ebola.\n-   Disease transmission does not occur during the latent period because of low levels of the virus in the host.\n:::\n:::::\n\n------------------------------------------------------------------------\n\n![](images/model_diagrams/model_diagrams.007.jpeg)\n\n------------------------------------------------------------------------\n\n::::: columns\n::: {.column width=\"50%\"}\n![](images/model_diagrams/model_diagrams.007.jpeg)\n:::\n\n::: {.column width=\"50%\"}\n-   The SEIR model extends the SIR model to include an exposed compartment, [$E$]{style=\"color:blue;\"}.\n-   [$E$]{style=\"color:blue;\"}: infected but are not yet infectious.\n-   Individuals stay in [$E$]{style=\"color:blue;\"} for [$1/\\sigma$]{style=\"color:blue;\"} days before moving to $I$.\n:::\n:::::\n\n------------------------------------------------------------------------\n\n::::: columns\n::: {.column width=\"60%\"}\n![](images/model_diagrams/model_diagrams.008.jpeg){width=\"80%\"}\n:::\n\n::: {.column width=\"40%\"}\nModel equations: \\begin{align*}\n\\frac{dS}{dt} & = -\\beta S I \\\\\n\\frac{dE}{dt} & = \\beta S I - \\color{orange}{\\sigma E} \\\\\n\\frac{dI}{dt} & = \\color{orange}{\\sigma E} - \\gamma I \\\\\n\\frac{dR}{dt} & = \\gamma I\n\\end{align*}\n:::\n:::::\n\n------------------------------------------------------------------------\n\n### SEIR model with births and deaths\n\n-   Let's relax the assumption about births and deaths in the population.\n\n-   We will assume that the susceptible population is replenished with new individuals at a constant rate, $\\mu$.\n\n-   We will also assume that everyone dies at a constant rate, $\\mu$.\n\n------------------------------------------------------------------------\n\nOur model schematic now looks like this:\n\n![](images/model_diagrams/model_diagrams.009.jpeg)\n\n::: notes\nExplain in terms of inflows and outflows\n:::\n\n------------------------------------------------------------------------\n\n::::: columns\n::: {.column width=\"50%\"}\n![](images/model_diagrams/model_diagrams.009.jpeg)\n:::\n\n::: {.column width=\"50%\"}\nThe model equations now become:\n\n\\begin{align}\n\\frac{dS}{dt} & = \\color{green}{\\mu N} - \\beta S I - \\color{blue}{\\mu} S \\\\\n\\frac{dE}{dt} & = \\beta S I - \\sigma E - \\color{blue}{\\mu} E \\\\\n\\frac{dI}{dt} & = \\sigma E - \\gamma I - \\color{blue}{\\mu} I \\\\\n\\frac{dR}{dt} & = \\gamma I - \\color{blue}{\\mu} R\n\\end{align}\n:::\n:::::\n\n<!-- ------------------------------------------------------------------------ -->\n\n<!-- #### Practicals -->\n\n<!-- -   Let's implement the SEIR model in R using the script `02_seir.Rmd`. -->\n\n------------------------------------------------------------------------\n\n::: {.callout-caution collapse=\"true\" icon=\"false\"}\n#### Discussion\n\nWhat is the $R0$ of the SEIR model?\n:::\n\n------------------------------------------------------------------------\n\n### The R0 of the SEIR Model\n\n-   Beyond the SIR model, calculating $R0$ for more complex models can be challenging due to the presence of multiple compartments.\n\n-   For complex models, we use the [next generation matrix]{style=\"color:tomato;\"} approach [@diekmann1990definition; @diekmann2010construction].\n\n::: {.callout-note collapse=\"true\" icon=\"false\"}\nUsing the next generation matrix approach, we can show that the SEIR model with constant births and deaths has $$R0 = \\dfrac{\\beta \\sigma}{(\\gamma + \\mu)(\\sigma + \\mu)}$$.\n:::\n\n------------------------------------------------------------------------\n\n<!-- {{< include _05_01_next_generation_matrix.qmd >}} -->\n\n<!-- ------------------------------------------------------------------------ -->\n\n### Numerical simulations\n\n#### R Practicals\n\n-   We can use the same approach as the SIR model to simulate the SEIR model.\n\n-   Modify the [`sir.Rmd`](https://github.com/jamesmbaazam/mppr_r_practicals/tree/main/model_implementation_practicals) script to simulate the SEIR model.\n\n------------------------------------------------------------------------\n\n::: {.fragment style=\"font-size: 450%\"}\nAny Questions?\n:::\n\n\n\n# Modelling epidemic control\n\n\n::: callout-note\nFor a recap on the various control measures, refer to @sec-control-measures.\n:::\n\n------------------------------------------------------------------------\n\n## Vaccination\n\n::: {callout-note}\nFor a background on vaccination, refer to @sec-vaccination.\n:::\n\n------------------------------------------------------------------------\n\n::::: columns\n::: {.column width=\"40%\"}\n![](images/vaccine.jpeg){width=\"100%\"}\n:::\n\n::: {.column width=\"60%\"}\n-   Vaccination is one of the most effective ways to control infectious diseases.\n-   Conceptually, vaccination works to reduce the number of susceptible individuals, $S$.\n:::\n:::::\n\n------------------------------------------------------------------------\n\n-   There are different types of vaccination strategies, including:\n\n    -   [pediatric]{style=\"color:tomato\"} vaccination: vaccinating children to prevent the spread of diseases.\n    -   [mass/random]{style=\"color:tomato\"} vaccination: vaccinating a large proportion of the population.\n    -   [targeted]{style=\"color:tomato\"} vaccination: vaccinating specific groups of individuals, example, healthcare workers.\n    -   [pulse]{style=\"color:tomato\"} vaccination: periodically vaccinating a large number of individuals.\n\n------------------------------------------------------------------------\n\n-   Let's consider the case of mass/random vaccination.\n\n-   Compartmental models can be extended to capture this by adding a new compartment, $V$.\n\n-   Let's consider the SEIR model with vaccination.\n\n------------------------------------------------------------------------\n\n### The Susceptible-Exposed-Infected-Recovered-Vaccinated (SEIRV) Model\n\n![](images/model_diagrams/model_diagrams.010.jpeg)\n\n------------------------------------------------------------------------\n\n::::: columns\n::: {.column width=\"40%\"}\n![](images/model_diagrams/model_diagrams.010.jpeg)\n:::\n\n::: {.column width=\"60%\"}\n-   The SEIRV model is simply the SEIR model with a vaccinated compartment, $V$.\n-   The vaccinated compartment represents previously susceptible individuals who have been vaccinated and are immune to the disease.\n:::\n:::::\n\n------------------------------------------------------------------------\n\n-   The vaccinated compartment is:\n\n    -   not infectious and does not move to the exposed or infectious compartments.\n\n    -   replenished by the rate of vaccination, $\\eta$.\n\n------------------------------------------------------------------------\n\nThe model diagram and equations are as follows:\n\n::::: columns\n::: {.column width=\"40%\"}\n\\begin{align}\n\\frac{dS}{dt} & = -\\beta S I - \\eta S \\\\\n\\frac{dE}{dt} & = \\beta S I - \\sigma E \\\\\n\\frac{dI}{dt} & = \\sigma E - \\gamma I \\\\\n\\frac{dR}{dt} & = \\gamma I \\\\\n\\frac{dV}{dt} & = \\eta S\n\\end{align}\n:::\n\n::: {.column width=\"60%\"}\n![](images/model_diagrams/model_diagrams.010.jpeg)\n:::\n:::::\n\nwhere $\\eta$ is the rate of vaccination.\n\n------------------------------------------------------------------------\n\n::: {.callout-caution collapse=\"true\" icon=\"false\"}\n#### Discussion\n\n-   What are some of the assumptions of the SEIRV model?\n\n-   What are the implications of these assumptions for the model's predictions?\n:::\n\n------------------------------------------------------------------------\n\n### Numerical simulations\n\n#### R Practicals\n\n-   We can use the same approach as the SIR and SEIR models to simulate the SEIRV model.\n\n-   Modify the `seir.Rmd` script to simulate the SEIRV model.\n\n------------------------------------------------------------------------\n\n## Non-Pharmaceutical Interventions (NPIs)\n\n::: {callout-note}\nFor a background on non-pharmaceutical interventions, refer to @sec-npi.\n:::\n\n------------------------------------------------------------------------\n\n-   Conceptually, NPIs usually act to either reduce the transmission rate, $\\beta$ or prevent infected individuals from transmitting.\n\n-   NPIs like isolation, social distancing and movement restrictions can reduce the transmission rate, $\\beta$, by reducing the contact rate between susceptible and infectious individuals.\n\n-   Hygiene measures reduce the probability of transmission per contact, thereby reducing the transmission rate, $\\beta$, since $\\beta = c \\times p$.\n\n------------------------------------------------------------------------\n\n-   Let's consider two scenarios that will extend the SIR model to include NPIs:\n\n    1.  Modifying the transmission rate, $\\beta$.\n    2.  Preventing infected individuals from transmitting through isolation.\n\n------------------------------------------------------------------------\n\n### Modifying the transmission rate\n\n-   NPIs such as social distancing, mask-wearing, and hand hygiene can reduce the transmission rate, $\\beta$.\n\n-   We can model this by making the transmission rate a function of time, $\\beta (t)$.\n\n------------------------------------------------------------------------\n\nThe modified SIR model with a reduced transmission rate is as follows:\n\n\\begin{align*}\n\\frac{dS}{dt} & = -\\beta (t) S I \\\\\n\\frac{dI}{dt} & = \\beta (t) S I - \\gamma I \\\\\n\\frac{dR}{dt} & = \\gamma I\n\\end{align*}\n\n------------------------------------------------------------------------\n\n-   The simplest form is to reduce $\\beta$ by an NPI efficacy, say $\\epsilon$.\n\n-   Assuming the NPI is implemented between $t_{\\text{npi\\_start}}$ and $t_{\\text{npi\\_end}}$, it means that $\\beta$ remains the same before that period and is modified to $(1- \\epsilon)\\beta$ during the period of the NPI, where $0 \\leq \\epsilon \\leq 1$.\n\n-   With this knowledge, we can define $\\beta (t)$ mathematically as:\n\n\\begin{equation*}\n\\beta(t) = \\begin{cases}\n\\beta & \\text{if } t < t_{\\text{npi\\_start}} \\text{ or } t > t_{\\text{npi\\_end}} \\\\\n(1 - \\epsilon) \\beta & \\text{if } t_{\\text{npi\\_start}} \\le t \\le t_{\\text{npi\\_end}}\n\\end{cases}\n\\end{equation*}\n\n------------------------------------------------------------------------\n\n#### R Practicals\n\n-   Let's open the script file `sir_npi.R` and follow along.\n\n------------------------------------------------------------------------\n\n### NPIs as compartments\n\n-   In the previous example, we retained the SIR model structure and modified the transmission rate.\n\n-   We can also model NPIs as compartments in the model. This is useful when we want to treat individuals affected by the NPIs differently.\n\n------------------------------------------------------------------------\n\n-   For example, isolation is an NPI that prevents infected individuals from transmitting the disease.\n\n-   This means that infected individuals in isolation do not contribute to the transmission of the disease and need to be removed from the infected compartment.\n\n-   Moving isolated individuals to a separate compartment allows us to track them separately in the model and apply relevant parameters.\n\n------------------------------------------------------------------------\n\n-   We can model this by introducing a new compartment, $Q$, for isolating infected individuals.\n\n-   Let's assume, infected individuals move to the isolated compartment at a rate, $\\delta$.\n\n-   Infected individuals in the isolated compartment do not transmit the disease.\n\n------------------------------------------------------------------------\n\nThe modified SIR model with isolated is as follows:\n\n\\begin{align*}\n\\frac{dS}{dt} & = -\\beta S I \\\\\n\\frac{dI}{dt} & = \\beta S I - \\gamma I - \\delta I \\\\\n\\frac{dR}{dt} & = \\gamma I + \\tau Q \\\\\n\\frac{dQ}{dt} & = \\delta I - \\tau Q\n\\end{align*}\n\nwhere $\\delta$ is the rate at which infected individuals move to the isolated compartment, and $\\tau$ is the rate at which individuals recover from isolation.\n\n------------------------------------------------------------------------\n\n##### R Practicals\n\n-   We can use the same approach as the SIR model to simulate the model with isolation.\n-   Modify the SIR model in [`sir.Rmd`](https://github.com/jamesmbaazam/mppr_r_practicals/tree/main/model_implementation_practicals) to incorporate the isolated compartment, $Q$ and the relevant parameters.\n\n------------------------------------------------------------------------\n\n::: {.fragment style=\"font-size: 450%\"}\nAny Questions?\n:::\n\n\n\n# Brief notes on modelling host heterogeneity\n\n\n-   The models we have discussed so far assume that all individuals in the population are identical.\n\n-   However, in reality, individuals differ in their susceptibility to infection and their ability to transmit the disease.\n\n-   It is essential to capture this heterogeneity in the models in order for the models to be more realistic and useful for decision-making.\n\n------------------------------------------------------------------------\n\n-   This can be captured by incorporating heterogeneity into the models.\n\n-   Heterogeneity is often captured by stratifying the population into different groups.\n\n------------------------------------------------------------------------\n\n## Age structure\n\n-   For many infectious diseases, the risk of infection and the severity of the disease vary by age.\n\n-   Hence, it is essential to capture age structure in the models.\n\n-   To do this, we divide the population into different age groups and model the disease dynamics within each age group.\n\n-   Let's extend the SIR model to include age structure.\n\n------------------------------------------------------------------------\n\n-   We will divide the population into $n$ age groups.\n\n-   Because the homogeneous model has 3 compartments, the age structured one will have $3n$ compartments: $S_1, I_1, R_1, S_2, I_2, R_2, ..., S_n, I_n, R_n$.\n\n------------------------------------------------------------------------\n\n-   The (compact) model equations are as follows:\n\n\\begin{align*}\n\\dfrac{dS_i}{dt} &= -\\sum_{j=1}^{n} \\beta_{ji} S_i I_j \\\\\n\\dfrac{dI_i}{dt} &= \\sum_{j=1}^{n} \\beta_{ji} S_i I_j - \\gamma I_i \\\\\n\\dfrac{dR_i}{dt} &= \\gamma I_i\n\\end{align*}\n\n------------------------------------------------------------------------\n\n-   The model can be used to study the impact of age structure on the dynamics of the epidemic.\n\n-   For example, we can study the impact of vaccinating different age groups on the dynamics of the epidemic.\n\n------------------------------------------------------------------------\n\n## Other Heterogeneities\n\n-   Other forms of heterogeneity that can be incorporated into the models include:\n    -   Spatial heterogeneity\n    -   Temporal heterogeneity\n    -   Contact heterogeneity\n    -   Heterogeneity in host behavior\n\n------------------------------------------------------------------------\n\n::: {.fragment style=\"font-size: 450%\"}\nAny Questions?\n:::\n\n\n\n------------------------------------------------------------------------\n\n# Final Remarks\n\n## Takeaways\n\n\nIn the last two days, we have covered a lot of ground. Here are some key takeaways:\n\n-   Infectious diseases are a major public health concern that can have devastating consequences.\n\n-   Mathematical models are essential tools for studying the dynamics of infectious diseases and informing public health decision-making.\n\n-   Models are simplifications of reality that help us understand complex systems.\n\n------------------------------------------------------------------------\n\n-   We have discussed several compartmental models, including the SIR, SEIR, and SEIRV models.\n\n-   The SIR model is a simple compartmental model that divides the population into three compartments: susceptible, infected, and recovered.\n\n-   The SEIR model extends the SIR model by adding an exposed compartment.\n\n-   We can model various pharmaceutical and non-pharmaceutical interventions (NPIs) by modifying the transmission rate or adding new compartments.\n\n------------------------------------------------------------------------\n\n-   We have discussed the basic reproduction number, $R0$, which is a key parameter in infectious disease epidemiology.\n\n-   $R0$ is the average number of secondary infections produced by a single infected individual in a completely susceptible population.\n\n-   If $R0 > 1$, the disease will spread in the population; if $R0 < 1$, the disease will die out.\n\n------------------------------------------------------------------------\n\n-   Deriving the basic reproduction number, $R0$, is an essential step in understanding the dynamics of infectious diseases.\n\n-   Deriving $R0$ for the simple SIR model is simple as we just need to study the threshold phenomena.\n\n-   For more complex models, we can use the next-generation matrix approach to derive $R0$.\n\n------------------------------------------------------------------------\n\n-   Often, homogeneous models are not sufficient to capture the complexity of infectious diseases.\n\n-   Incorporating heterogeneity into the models is essential for capturing the complexity of infectious diseases.\n\n-   Age structure is a common form of heterogeneity that can be incorporated into the models.\n\n-   Other forms of heterogeneity include spatial, temporal, and contact heterogeneity.\n\n\n\n------------------------------------------------------------------------\n\n## What skills are needed to build and use infectious disease models?\n\n\n![A non-exhaustive list of skills needed for modelling infectious diseases.](images/modelling_skills.jpeg)\n\n\n\n------------------------------------------------------------------------\n\n## Contact Information\n\n\n**James Mba Azam, PhD**\n\n[*Epiverse-TRACE Initiative, London School of Hygiene and Tropical Medicine, UK*](https://epiverse-trace.github.io/)\n\n**Email:** [james.azam\\@lshtm.ac.uk](mailto:james.azam@lshtm.ac.uk)\n\n**ORCID:** [0000-0001-5782-7330](https://orcid.org/0000-0001-5782-7330)\n\n**Social Media:**\n\n**LinkedIn:** [James Azam](https://www.linkedin.com/in/james-azam-phd-6b5b00176/)\n\n**Twitter:** [james_azam](https://twitter.com/james_azam)\n\n**GitHub:** [jamesmbaazam](https://github.com/jamesmbaazam)\n\n\n\n------------------------------------------------------------------------\n\n![](https://i.creativecommons.org/l/by/4.0/88x31.png) This presentation is made available through a [Creative Commons Attribution 4.0 International License](https://creativecommons.org/licenses/by/4.0/)\n\n# List of Resources\n\n\n## Textbooks\n\n::: {layout-ncol=\"2\"}\n\n![Infectious Diseases of Humans: Dynamics and Control by Roy M. Anderson and Robert M. May](images/Anderson_and_May.jpeg){width=\"60%\"}\n\n![Infectious Disease Modelling by Emilia Vynnycky and Richard White](images/ID_modelling_Vynnycky_and_White.jpeg){width=\"60%\"}\n\n:::\n\n------------------------------------------------------------------------\n\n::: {layout-ncol=\"2\"}\n\n![Modeling Infectious Diseases in Humans and Animals by Matt Keeling and Pejman Rohani](images/Rohani_and_Keeling.jpeg){width=\"60%\"}\n\n![Epidemics: Models and Data Using R by Ottar N. Bjornstad](images/Epidemics_Ottar.jpg){width=\"60%\"}\n\n:::\n\n------------------------------------------------------------------------\n\n## Papers and Articles {.smaller}\n\n------------------------------------------------------------------------\n\n### Modelling infectious disease transmission\n\n- Grassly, N. C., & Fraser, C. (2008). Mathematical models of infectious disease transmission. Nature Reviews Microbiology, 6(6), 477–487. <https://doi.org/10.1038/nrmicro1845>\n\n- Kirkeby, C., Brookes, V. J., Ward, M. P., Dürr, S., & Halasa, T. (2021). A practical introduction to mechanistic modeling of disease transmission in veterinary science. Frontiers in veterinary science, 7, 546651. <https://www.frontiersin.org/articles/10.3389/fvets.2020.546651/full>\n\n------------------------------------------------------------------------\n\n- Blackwood, J. C., & Childs, L. M. (2018). An introduction to compartmental modeling for the budding infectious disease modeler. <https://vtechworks.lib.vt.edu/items/61e9ca00-ef21-4356-bcd7-a9294a1d2f17>\n\n------------------------------------------------------------------------\n\n- Cobey, S. (2020). Modeling infectious disease dynamics. Science, 368(6492), 713–714. <https://doi.org/10.1126/science.abb5659>\n\n- Bjørnstad, O. N., Shea, K., Krzywinski, M., & Altman, N. (2020). Modeling infectious epidemics. Nature Methods, 17(5), 455–456. <https://doi.org/10.1038/s41592-020-0822-z>\n\n------------------------------------------------------------------------\n\n- Bodner, K., Brimacombe, C., Chenery, E. S., Greiner, A., McLeod, A. M., Penk, S. R., & Soto, J. S. V. (2021). Ten simple rules for tackling your first mathematical models: A guide for graduate students by graduate students. PLOS Computational Biology, 17(1), e1008539. <https://doi.org/10.1371/journal.pcbi.1008539>\n\n- Mishra, S., Fisman, D. N., & Boily, M.-C. (2011). The ABC of terms used in mathematical models of infectious diseases. Journal of Epidemiology & Community Health, 65(1), 87–94. <https://jech.bmj.com/content/65/1/87>\n\n------------------------------------------------------------------------\n\n- James, L. P., Salomon, J. A., Buckee, C. O., & Menzies, N. A. (2021). The Use and Misuse of Mathematical Modeling for Infectious Disease Policymaking: Lessons for the COVID-19 Pandemic. 41(4), 379–385. <https://doi.org/10.1177/0272989X21990391>\n\n- Holmdah, I., & Buckee, C. (2020). Wrong but useful—What COVID-19 epidemiologic models can and cannot tell us. New England Journal of Medicine. <https://doi.org/10.1056/nejmp2009027>\n\n------------------------------------------------------------------------\n\n- Metcalf, C. J. E. E., Edmunds, W. J., & Lessler, J. (2015). Six challenges in modelling for public health policy. Epidemics, 10(2015), 93–96. <https://doi.org/10.1016/j.epidem.2014.08.008>\n\n- Roberts, M., Andreasen, V., Lloyd, A., & Pellis, L. (2015). Nine challenges for deterministic epidemic models. Epidemics, 10(2015), 49–53. <https://doi.org/10.1016/j.epidem.2014.09.006>\n\n------------------------------------------------------------------------\n\n### Deriving and Interpreting R0 {.smaller}\n\n- Jones, J. H. (2011). Notes On R0. Building, 1–19. <https://web.stanford.edu/\\~jhj1/teachingdocs/Jones-on-R0.pdf>\n\n- Diekmann, O., Heesterbeek, J. A. P., & Metz, J. A. J. (1990). On the definition and the computation of the basic reproduction ratio R0 in models for infectious diseases in heterogeneous populations. Journal of Mathematical Biology, 28(4), 365–382. <https://doi.org/10.1007/BF00178324>\n\n------------------------------------------------------------------------\n\n- Diekmann, O., Heesterbeek, J. A. P., & Roberts, M. G. (2010). The construction of next-generation matrices for compartmental epidemic models. Journal of the Royal Society Interface, 7(47), 873–885. <https://doi.org/10.1098/rsif.2009.0386>\n\n---\n\n## Code repositories {.smaller}\n\n- [epirecipes](http://epirecip.es/epicookbook/): Code for collate mathematical models of infectious disease transmission, with implementations in R, Python, and Julia.\n\n- [Modeling Infectious Diseases in Humans and Animals](http://www.modelinginfectiousdiseases.org/): Code for the labelled programs in the book \"Modeling Infectious Diseases in Humans and Animals\". They are generally available as C++, Fortran and Matlab files.\n\n\n\n# References\n\n::: {#refs}\n:::\n",
    "supporting": [
      "slides_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}