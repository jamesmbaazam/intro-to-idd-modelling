{
  "hash": "8b323536b76f291c6e957992c53a117c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Introduction to Infectious Disease Modelling\"\nauthor:\n  - name: \"James Mba Azam, PhD\"\n    orcid: 0000-0001-5782-7330\n    email: james.azam@lshtm.ac.uk\n    affiliation: \n      - name: Epiverse-TRACE Initiative, London School of Hygiene and Tropical Medicine, UK\n        city: London, United Kingdom\ndate: \"last-modified\"\nexecute:\n  echo: true\n# format:\n#   beamer:\n#     navigation: horizontal\n#     theme: metropolis\n#     institute: Epiverse-TRACE Initiative, London School of Hygiene and Tropical Medicine, UK\nformat:\n  revealjs:\n    theme: [solarized, custom.scss]\n    slide-number: true\n    scrollable: true\n    chalkboard: true\n    toc: true\n    toc-depth: 1\ntransition: fade\nlightbox: true\nprogress: true\ncode-copy: true\n# revealjs-plugins:\n#   - revealjs-text-resizer\nbibliography: references.bib\nlink-citations: true\nengine: knitr\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n<!-- # An overview of infectious diseases -->\n\n<!-- {{< include _01_infectious_diseases_overview.qmd >}} -->\n\n<!-- # Infectious disease models -->\n\n<!-- {{< include _02_infectious_disease_models.qmd >}} -->\n\n<!-- # Introduction to compartmental models -->\n\n<!-- {{< include _03_compartmental_models.qmd >}} -->\n\n<!-- ## The Susceptible-Infected-Recovered (SIR) model -->\n\n<!-- {{< include _04_sir_model.qmd >}} -->\n\n## The Susceptible-Exposed-Infected-Recovered (SEIR) Model\n\n\n![Timeline of infection. Source: Keeling & Rohani, 2008](images/infection_timeline.png)\n\n------------------------------------------------------------------------\n\n::: columns\n::: {.column width=\"30%\"}\n![The SARS-COV-2 virus](images/corona_virus.jpeg)\n\n![The Ebola virus](images/ebola_virus.jpeg)\n:::\n\n::: {.column width=\"70%\"}\n-   Some diseases have an [latent/exposed period]{style=\"color:tomato;\"} during which individuals are [infected but not yet infectious]{style=\"color:tomato;\"}. Examples include pertussis, COVID-19, and Ebola.\n-   Disease transmission does not occur during the latent period because of low levels of the virus in the host.\n:::\n:::\n\n------------------------------------------------------------------------\n\n![](images/model_diagrams/model_diagrams.007.jpeg)\n\n------------------------------------------------------------------------\n\n::: columns\n::: {.column width=\"50%\"}\n![](images/model_diagrams/model_diagrams.007.jpeg)\n:::\n\n::: {.column width=\"50%\"}\n-   The SEIR model extends the SIR model to include an exposed compartment, [$E$]{style=\"color:blue;\"}.\n-   [$E$]{style=\"color:blue;\"}: infected but are not yet infectious.\n-   Individuals stay in [$E$]{style=\"color:blue;\"} for [$1/\\sigma$]{style=\"color:blue;\"} days before moving to $I$.\n:::\n:::\n\n------------------------------------------------------------------------\n\n::: columns\n::: {.column width=\"60%\"}\n![](images/model_diagrams/model_diagrams.008.jpeg){width=\"80%\"}\n:::\n\n::: {.column width=\"40%\"}\nModel equations: \\begin{align*}\n\\frac{dS}{dt} & = -\\beta S I \\\\\n\\frac{dE}{dt} & = \\beta S I - \\color{orange}{\\sigma E} \\\\\n\\frac{dI}{dt} & = \\color{orange}{\\sigma E} - \\gamma I \\\\\n\\frac{dR}{dt} & = \\gamma I\n\\end{align*}\n:::\n:::\n\n------------------------------------------------------------------------\n\n### SEIR model with births and deaths\n\n-   Let's relax the assumption about births and deaths in the population.\n\n-   We will assume that the susceptible population is replenished with new individuals at a constant rate, $\\mu$.\n\n-   We will also assume that everyone dies at a constant rate, $\\mu$.\n\n------------------------------------------------------------------------\n\nOur model schematic now looks like this:\n\n![](images/model_diagrams/model_diagrams.009.jpeg)\n\n::: notes\nExplain in terms of inflows and outflows\n:::\n\n------------------------------------------------------------------------\n\n::: columns\n::: {.column width=\"50%\"}\n![](images/model_diagrams/model_diagrams.009.jpeg)\n:::\n\n::: {.column width=\"50%\"}\nThe model equations now become:\n\n\n```{=tex}\n\\begin{align}\n\\frac{dS}{dt} & = \\color{green}{\\mu N} - \\beta S I - \\color{blue}{\\mu} S \\\\\n\\frac{dE}{dt} & = \\beta S I - \\sigma E - \\color{blue}{\\mu} E \\\\\n\\frac{dI}{dt} & = \\sigma E - \\gamma I - \\color{blue}{\\mu} I \\\\\n\\frac{dR}{dt} & = \\gamma I - \\color{blue}{\\mu} R\n\\end{align}\n```\n\n:::\n:::\n\n<!-- ------------------------------------------------------------------------ -->\n\n<!-- #### Practicals -->\n\n<!-- -   Let's implement the SEIR model in R using the script `02_seir.Rmd`. -->\n\n------------------------------------------------------------------------\n\n::: {.callout-caution collapse=\"true\" icon=\"false\"}\n#### Discussion\n\nWhat is the $R0$ of the SEIR model?\n:::\n\n------------------------------------------------------------------------\n\n### The R0 of the SEIR Model\n\n-   Beyond the SIR model, calculating $R0$ for more complex models can be challenging due to the presence of multiple compartments.\n\n-   For complex models, we use the [next generation matrix]{style=\"color:tomato;\"} approach [@diekmann1990definition; @diekmann2010construction].\n\n::: {.callout-note collapse=\"true\" icon=\"false\"}\nUsing the next generation matrix approach, we can show that the SEIR model with constant births and deaths has $$R0 = \\dfrac{\\beta \\sigma}{(\\gamma + \\mu)(\\sigma + \\mu)}$$.\n:::\n\n------------------------------------------------------------------------\n\n<!-- ------------------------------------------------------------------------ -->\n\n<!-- #### The next-generation matrix approach -->\n\n<!-- - The next-generation matrix (NGM) approach focuses on all the infected compartments. -->\n\n<!-- - Let's outline the steps to derive $R0$ using the NGM approach [@diekmann2010construction]. -->\n\n<!-- --- -->\n\n<!-- - Step 1: Identify the compartments that produce new infections and describe how infections are changing over time. This subset of the system is called the \"infected subsystem\". -->\n\n<!-- - Note the infected subsystem/compartments by a vector $x$ and the uninfected subsystem by $y$.  -->\n\n<!--     - For example, for the SEIR model, $x = (E, I)$ and $y = (S, R)$. -->\n\n<!-- --- -->\n\n<!-- - For each infected compartment, extract the following components: -->\n\n<!--     - $F_i(x,y)$: the rate of new infections entering compartment $i$, and -->\n\n<!--     - $V_i(x,y) = V_i^-(x,y) - V_i^+(x,y)$, that is, the rate of transfers out of compartment $i$ minus the rate of transfers into the compartment. -->\n\n<!-- - Essentially, each infected compartment can be written as $\\dfrac{d x_i}{dt} = F_i(x,y) - V_i(x,y)$. -->\n\n<!-- --- -->\n\n<!-- Step 2: Find $\\mathcal{F}$ and $\\mathcal{V}$, the matrix of partial derivatives for $F$ and $V$ respectively and evaluate at the disease-free equilibrium. This is called the Jacobian matrix (See @sec-jacobian). -->\n\n<!-- ::: callout-note -->\n\n<!-- The disease-free equilibrium is the state where no infections are present. For an SEIR model, this is denoted as $(S^*, E^*, I^*, R^*) = (N, 0, 0, 0)$, where $N$ is the total population size. -->\n\n<!-- ::: -->\n\n<!-- ------------------------------------------------------------------------ -->\n\n<!-- ##### The Jacobian matrix {#sec-jacobian} -->\n\n<!-- -   The Jacobian matrix is a matrix of first-order partial derivatives of a function. -->\n\n<!-- -   What does it look like? -->\n\n<!-- ------------------------------------------------------------------------ -->\n\n<!-- ```{=tex} -->\n\n<!-- \\begin{equation*} -->\n\n<!-- J = \\begin{bmatrix} -->\n\n<!-- \\dfrac{\\partial f_1}{\\partial x_1} & \\dfrac{\\partial f_1}{\\partial x_2} & \\cdots & \\dfrac{\\partial f_1}{\\partial x_n} \\\\ -->\n\n<!-- \\dfrac{\\partial f_2}{\\partial x_1} & \\dfrac{\\partial f_2}{\\partial x_2} & \\cdots & \\dfrac{\\partial f_2}{\\partial x_n} \\\\ -->\n\n<!-- \\vdots & \\vdots & \\ddots & \\vdots \\\\ -->\n\n<!-- \\dfrac{\\partial f_n}{\\partial x_1} & \\dfrac{\\partial f_n}{\\partial x_2} & \\cdots & \\dfrac{\\partial f_n}{\\partial x_n} -->\n\n<!-- \\end{bmatrix} -->\n\n<!-- \\end{equation*} -->\n\n<!-- ``` -->\n\n<!-- where $f_i$ is the $i$-th function of the function and $x_i$ is the $i$-th variable. -->\n\n<!-- ------------------------------------------------------------------------ -->\n\n<!-- -   Step 3: Solve $\\mathcal{F}\\mathcal{V}^{-1}$ to obtain the next-generation matrix, $\\mathcal{G}$. -->\n\n<!-- -   Step 4: Determine the spectral radius, $\\rho$, of $\\mathcal{G}$, which is the [dominant (largest absolute) eigenvalue]{style=\"color:tomato;\"} of the NGM. -->\n\n<!-- --- -->\n\n<!-- $R0$ is the dominant eigenvalue of the next generation matrix. -->\n\n<!-- ::: {.callout-note} -->\n\n<!-- - If you are wondering why $R0$ is taken to be the spectral radius of the NGM, see [@brouwer2022spectral]. -->\n\n<!-- - [@brouwer2022spectral] also provides a detailed explanation of the the building blocks of $R0$ and the intuition behind it. -->\n\n<!-- ::: -->\n\n<!-- ------------------------------------------------------------------------ -->\n\n<!-- ##### Steps to determine the Spectral Radius -->\n\n<!-- -   Find the Eigenvalues: -->\n\n<!--     -   Given a square matrix $A$, compute the eigenvalues $\\lambda$ by solving the characteristic equation: -->\n\n<!-- ```{=tex} -->\n\n<!-- \\begin{equation*} -->\n\n<!-- \\begin{aligned} -->\n\n<!-- \\text{det}(A - \\lambda I) = 0 -->\n\n<!-- \\end{aligned} -->\n\n<!-- \\end{equation*} -->\n\n<!-- ``` -->\n\n<!-- where $I$ is the identity matrix of the same dimension as $A$, and $\\text{det}$ denotes the determinant. -->\n\n<!-- ------------------------------------------------------------------------ -->\n\n<!-- -   Compute the Spectral Radius, $\\rho(A) = \\max \\{ |\\lambda_1|, |\\lambda_2|, \\ldots, |\\lambda_n|$ -->\n\n<!-- where $\\lambda_1, \\lambda_2, \\ldots, \\lambda_n$ are the eigenvalues of $A$, and $|\\lambda_i|$ denotes the absolute value of the eigenvalue $\\lambda_i$. -->\n\n<!-- Let's apply these ideas to derive the $R0$ of the SEIR model. -->\n\n<!-- ------------------------------------------------------------------------ -->\n\n<!-- #### Deriving the R0 of the SEIR model -->\n\n<!-- Step 1: identify the infected compartments $E$ and $I$: -->\n\n<!-- ```{=tex} -->\n\n<!-- \\begin{equation*} -->\n\n<!-- \\begin{aligned} -->\n\n<!-- \\frac{dE}{dt} &= \\beta S I - \\sigma E, \\\\ -->\n\n<!-- \\frac{dI}{dt} &= \\sigma E - \\gamma I. -->\n\n<!-- \\end{aligned} -->\n\n<!-- \\end{equation*} -->\n\n<!-- ``` -->\n\n<!-- ------------------------------------------------------------------------ -->\n\n<!-- Step 2: Decompose the system into $\\mathcal{F}$, and $\\mathcal{V}$: -->\n\n<!-- Define: -->\n\n<!-- -   $\\mathcal{F}$: new infection terms -->\n\n<!-- -   $\\mathcal{V}$: transition terms -->\n\n<!-- \\begin{equation*} -->\n\n<!-- \\mathbf{F} = \\begin{pmatrix} -->\n\n<!-- \\beta S I \\\\ -->\n\n<!-- 0 -->\n\n<!-- \\end{pmatrix}, -->\n\n<!-- \\quad -->\n\n<!-- \\mathbf{V} = \\begin{pmatrix} -->\n\n<!-- \\sigma E \\\\ -->\n\n<!-- \\gamma I - \\sigma E -->\n\n<!-- \\end{pmatrix} -->\n\n<!-- \\end{equation*} -->\n\n<!-- ------------------------------------------------------------------------ -->\n\n<!-- Calculate the matrix of partial derivatives of $\\mathcal{F}$ and $\\mathcal{V}$ with respect to $E$ and $I$ and evaluate at the disease-free equilibrium (DFE) $(S^*, E^*, I^*, R^*) = (N, 0, 0, 0)$: -->\n\n<!-- \\begin{equation*} -->\n\n<!-- \\mathcal{F} = \\begin{bmatrix} -->\n\n<!-- \\dfrac{\\partial{(\\beta S I)}}{\\partial{E}} & \\dfrac{\\partial{(\\beta S I)}}{\\partial{I}} \\\\ -->\n\n<!-- \\dfrac{\\partial{(0)}}{\\partial{E}} & \\dfrac{\\partial{(0)}}{\\partial{I}} -->\n\n<!-- \\end{bmatrix}_{\\substack{S = N, E = I = R = 0}}, -->\n\n<!-- \\quad -->\n\n<!-- \\mathcal{V} = \\begin{bmatrix} -->\n\n<!-- \\dfrac{\\partial{(\\sigma E)}}{\\partial{E}} & \\dfrac{\\partial{(\\sigma E)}}{\\partial{I}} \\\\ -->\n\n<!-- \\dfrac{\\partial{(\\gamma I - \\sigma E)}}{\\partial{E}} & \\dfrac{\\partial{(\\gamma I - \\sigma E)}}{\\partial{I}} -->\n\n<!-- \\end{bmatrix}_{\\substack{S = N, E = I = R = 0}} -->\n\n<!-- \\end{equation*} -->\n\n<!-- --- -->\n\n<!-- ```{=tex} -->\n\n<!-- \\begin{equation*} -->\n\n<!-- \\mathcal{F} = \\begin{pmatrix} -->\n\n<!-- 0 & \\beta N \\\\ -->\n\n<!-- 0 & 0 -->\n\n<!-- \\end{pmatrix}, -->\n\n<!-- \\quad -->\n\n<!-- \\mathcal{V} = \\begin{pmatrix} -->\n\n<!-- -\\sigma & 0 \\\\ -->\n\n<!-- \\sigma & -\\gamma -->\n\n<!-- \\end{pmatrix} -->\n\n<!-- \\end{equation*} -->\n\n<!-- ``` -->\n\n<!-- ------------------------------------------------------------------------ -->\n\n<!-- We aim to solve -->\n\n<!-- ```{=tex} -->\n\n<!-- \\begin{equation*} -->\n\n<!-- \\mathcal{G} = \\mathcal{F} \\mathcal{V}^{-1} -->\n\n<!-- \\end{equation*} -->\n\n<!-- ``` -->\n\n<!-- Let's compute $\\mathcal{V}^{-1}$: -->\n\n<!-- ```{=tex} -->\n\n<!-- \\begin{equation*} -->\n\n<!-- \\mathcal{V}^{-1} = \\begin{pmatrix} -->\n\n<!-- \\frac{1}{\\sigma} & 0 \\\\ -->\n\n<!-- \\frac{1}{\\gamma} & \\frac{1}{\\sigma} -->\n\n<!-- \\end{pmatrix} -->\n\n<!-- \\end{equation*} -->\n\n<!-- ``` -->\n\n<!-- ------------------------------------------------------------------------ -->\n\n<!-- ```{=tex} -->\n\n<!-- \\begin{equation*} -->\n\n<!-- \\mathcal{G} = \\begin{pmatrix} -->\n\n<!-- 0 & \\beta S_0 \\\\ -->\n\n<!-- 0 & 0 -->\n\n<!-- \\end{pmatrix} -->\n\n<!-- \\begin{pmatrix} -->\n\n<!-- \\frac{1}{\\sigma} & 0 \\\\ -->\n\n<!-- \\frac{1}{\\gamma} & \\frac{1}{\\sigma} -->\n\n<!-- \\end{pmatrix} -->\n\n<!-- = \\begin{pmatrix} -->\n\n<!-- \\frac{\\beta S_0}{\\gamma} & \\frac{\\beta S_0}{\\sigma} \\\\ -->\n\n<!-- 0 & 0 -->\n\n<!-- \\end{pmatrix} -->\n\n<!-- \\end{equation*} -->\n\n<!-- ``` -->\n\n<!-- ------------------------------------------------------------------------ -->\n\n<!-- $R_0$ is the spectral radius (dominant eigenvalue) of $\\mathcal{G}$: -->\n\n<!-- ```{=tex} -->\n\n<!-- \\begin{equation*} -->\n\n<!-- R_0 = \\rho(\\mathcal{G}) = \\frac{\\beta S_0}{\\gamma} -->\n\n<!-- \\end{equation*} -->\n\n<!-- ``` -->\n\n\n\n------------------------------------------------------------------------\n\n### Numerical simulations\n\n#### R Practicals\n\n-   We can use the same approach as the SIR model to simulate the SEIR model.\n\n-   Let's do a code walk through in R using the `01_seir.Rmd` script.\n\n\n\n# Modelling epidemic control\n\n\n::: callout-note\nFor a recap on the various control measures, refer to @sec-control-measures.\n:::\n\n------------------------------------------------------------------------\n\n## Vaccination\n\n::: {callout-note}\nFor a background on vaccination, refer to @sec-vaccination.\n:::\n\n------------------------------------------------------------------------\n\n::: columns\n::: {.column width=\"40%\"}\n![](images/vaccine.jpeg){width=\"150%\"}\n:::\n\n::: {.column width=\"60%\"}\n-   Vaccination is one of the most effective ways to control infectious diseases.\n-   Conceptually, vaccination works to reduce the number of susceptible individuals, $S$.\n:::\n:::\n\n------------------------------------------------------------------------\n\n-   There are different types of vaccination strategies, including:\n\n    -   [pediatric]{style=\"color:tomato\"} vaccination: vaccinating children to prevent the spread of diseases.\n    -   [mass/random]{style=\"color:tomato\"} vaccination: vaccinating a large proportion of the population.\n    -   [targeted]{style=\"color:tomato\"} vaccination: vaccinating specific groups of individuals, example, healthcare workers.\n    -   [pulse]{style=\"color:tomato\"} vaccination: periodically vaccinating a large number of individuals.\n\n------------------------------------------------------------------------\n\n-   Let's consider the case of mass/random vaccination.\n\n-   Compartmental models can be extended to capture this by adding a new compartment, $V$.\n\n-   Let's consider the SEIR model with vaccination.\n\n------------------------------------------------------------------------\n\n### The Susceptible-Exposed-Infected-Recovered-Vaccinated (SEIRV) Model\n\n![](images/model_diagrams/model_diagrams.010.jpeg)\n\n------------------------------------------------------------------------\n\n::: columns\n::: {.column width=\"40%\"}\n![](images/model_diagrams/model_diagrams.010.jpeg)\n:::\n\n::: {.column width=\"60%\"}\n-   The SEIRV model is simply the SEIR model with a vaccinated compartment, $V$.\n-   The vaccinated compartment represents previously susceptible individuals who have been vaccinated and are immune to the disease.\n:::\n:::\n\n------------------------------------------------------------------------\n\n-   The vaccinated compartment is:\n\n    -   not infectious and does not move to the exposed or infectious compartments.\n\n    -   replenished by the rate of vaccination, $\\eta$.\n\n------------------------------------------------------------------------\n\nThe model diagram and equations are as follows:\n\n::: columns\n::: {.column width=\"40%\"}\n\n```{=tex}\n\\begin{align}\n\\frac{dS}{dt} & = -\\beta S I - \\eta S \\\\\n\\frac{dE}{dt} & = \\beta S I - \\sigma E \\\\\n\\frac{dI}{dt} & = \\sigma E - \\gamma I \\\\\n\\frac{dR}{dt} & = \\gamma I \\\\\n\\frac{dV}{dt} & = \\eta S\n\\end{align}\n```\n\n:::\n\n::: {.column width=\"60%\"}\n![](images/model_diagrams/model_diagrams.010.jpeg)\n:::\n:::\n\nwhere $\\eta$ is the rate of vaccination.\n\n------------------------------------------------------------------------\n\n::: {.callout-caution collapse=\"true\" icon=\"false\"}\n#### Discussion\n\n-   What are some of the assumptions of the SEIRV model?\n\n-   What are the implications of these assumptions for the model's predictions?\n:::\n\n------------------------------------------------------------------------\n\n### Numerical simulations\n\n#### R Practicals\n\n-   We can use the same approach as the SIR and SEIR models to simulate the SEIRV model.\n\n-   Let's do a code walk through in R with the `02_seirv.Rmd` script.\n\n::: notes\nStudents are to modify the `02_seir.Rmd` script to include vaccination.\n:::\n\n------------------------------------------------------------------------\n\n## Non-Pharmaceutical Interventions (NPIs)\n\n::: {callout-note}\nFor a background on non-pharmaceutical interventions, refer to @sec-npi.\n:::\n\n------------------------------------------------------------------------\n\n-   Conceptually, NPIs usually act to either reduce the transmission rate, $\\beta$ or prevent infected individuals from transmitting.\n\n-   NPIs like quarantine, social distancing and movement restrictions can reduce the transmission rate, $\\beta$, by reducing the contact rate between susceptible and infectious individuals.\n\n-   Hygiene measures reduce the probability of transmission per contact, thereby reducing the transmission rate, $\\beta$, since $\\beta = c \\times p$.\n\n------------------------------------------------------------------------\n\n-   Let's consider two scenarios that will extend the SIR model to include NPIs:\n\n    1.  Modifying the transmission rate, $\\beta$.\n    2.  Preventing infected individuals from transmitting through quarantine.\n\n------------------------------------------------------------------------\n\n### Modifying the transmission rate\n\n-   NPIs such as social distancing, mask-wearing, and hand hygiene can reduce the transmission rate, $\\beta$.\n\n-   We can model this by making the transmission rate a function of time so that $\\beta(t)$.\n\n------------------------------------------------------------------------\n\nThe modified SIR model with a reduced transmission rate is as follows:\n\n\n```{=tex}\n\\begin{align*}\n\\frac{dS}{dt} & = -\\beta(t) S I \\\\\n\\frac{dI}{dt} & = \\beta (t) S I - \\gamma I \\\\\n\\frac{dR}{dt} & = \\gamma I\n\\end{align*}\n```\n\n\n------------------------------------------------------------------------\n\n-   The simplest form is to reduce $\\beta$ by an NPI efficacy, say $\\epsilon$.\n\n-   Assuming the NPI is implemented between $t_{npi_start}$ and $t_{npi_end}$, it means that $\\beta$ remains the same before that period and is reduced to $( 1- \\epsilon)$ during the period of the NPI.\n\n-   With this knowledge, we can define $\\beta(t)$ mathematically as:\n\n\n```{=tex}\n\\begin{align*}\n\\beta(t) = \\begin{cases}\n\\beta & \\text{if } t < t_{\\text{npi_start}} | t > t_{\\text{npi_end}} \\\\\n(1 - \\epsilon) \\beta & \\text{if } t_{\\text{npi_start}} \\le t \\le t_{\\text{npi_end}}\n\\end{cases}\n\\end{align*}\n```\n\n\n------------------------------------------------------------------------\n\n#### R Practicals\n\n-   Let's open the script file `02_sir_npi.R` and follow along.\n\n------------------------------------------------------------------------\n\n### NPIs as compartments\n\n-   In the previous example, we retained the SIR model structure and modified the transmission rate.\n\n-   We can also model NPIs as compartments in the model. This is useful when we want to treat individuals affected by the NPIs differently.\n\n------------------------------------------------------------------------\n\n-   For example, quarantine is an NPI that prevents infected individuals from transmitting the disease.\n\n-   This means that infected individuals under quarantine do not contribute to the transmission of the disease and need to be removed from the infected compartment.\n\n-   Moving quarantined individuals to a separate compartment allows us to track them separately in the model and apply relevant parameters.\n\n------------------------------------------------------------------------\n\n-   We can model this by introducing a new compartment, $Q$, for quarantining infected individuals.\n\n-   Let's assume, infected individuals move to the quarantine compartment at a rate, $\\delta$.\n\n-   Infected individuals in the quarantine compartment do not transmit the disease.\n\n------------------------------------------------------------------------\n\nThe modified SIR model with quarantine is as follows:\n\n\n```{=tex}\n\\begin{align*}\n\\frac{dS}{dt} & = -\\beta S I \\\\\n\\frac{dI}{dt} & = \\beta S I - \\gamma I - \\delta I \\\\\n\\frac{dR}{dt} & = \\gamma I + \\tau Q \\\\\n\\frac{dQ}{dt} & = \\delta I - \\tau Q\n\\end{align*}\n```\n\nwhere $\\delta$ is the rate at which infected individuals move to the quarantine compartment, and $\\tau$ is the rate at which individuals recover from quarantine.\n\n------------------------------------------------------------------------\n\n#### Scenarios with quarantine\n\n-   We can use the same approach as the SIR model to simulate the model with quarantine.\n\n-   Let's do a code walk though in R.\n\n\n\n# Brief notes on modelling host heterogeneity\n\n\n-   The models we have discussed so far assume that all individuals in the population are identical.\n\n-   However, in reality, individuals differ in their susceptibility to infection and their ability to transmit the disease.\n\n-   It is essential to capture this heterogeneity in the models in order for the models to be more realistic and useful for decision-making.\n\n---\n\n-   This can be captured by incorporating heterogeneity into the models.\n\n-   Heterogeneity is often captured by stratifying the population into different groups.\n\n---\n\n## Age structure\n\n-   For many infectious diseases, the risk of infection and the severity of the disease vary by age.\n\n-   Hence, it is essential to capture age structure in the models.\n\n-   To do this, we divide the population into different age groups and model the disease dynamics within each age group.\n\n-   Let's extend the SIR model to include age structure.\n\n---\n\n-   We will divide the population into $n$ age groups.\n\n-   Because the homogeneous model has 3 compartments, the age structured one will have $3n$ compartments: $S_1, I_1, R_1, S_2, I_2, R_2, ..., S_n, I_n, R_n$.\n\n---\n\n-   The (compact) model equations are as follows:\n\n\\begin{align}\n\\dfrac{dS_i}{dt} &= -\\sum_{j=1}^{n} \\beta_{ji} S_i I_j \\\\\n\\dfrac{dI_i}{dt} &= \\sum_{j=1}^{n} \\beta_{ji} S_i I_j - \\gamma I_i \\\\\n\\dfrac{dR_i}{dt} &= \\gamma I_i\n\\end{align}\n\n---\n\n-   The model can be used to study the impact of age structure on the dynamics of the epidemic.\n\n-   For example, we can study the impact of vaccinating different age groups on the dynamics of the epidemic.\n\n---\n\n## Other Heterogeneities\n\n-   Other forms of heterogeneity that can be incorporated into the models include:\n\n    -   Spatial heterogeneity\n    -   Temporal heterogeneity\n    -   Contact heterogeneity\n    -   Heterogeneity in host behavior\n\n\n\n# Final Remarks\n\n## Takeaways\n\n\nIn the last two days, we have covered a lot of ground. Here are some key takeaways:\n\n-   Infectious diseases are a major public health concern that can have devastating consequences.\n\n-   Mathematical models are essential tools for studying the dynamics of infectious diseases and informing public health decision-making.\n\n-   Models are simplifications of reality that help us understand complex systems.\n\n------------------------------------------------------------------------\n\n-   We have discussed several compartmental models, including the SIR, SEIR, and SEIRV models.\n\n-   The SIR model is a simple compartmental model that divides the population into three compartments: susceptible, infected, and recovered.\n\n-   The SEIR model extends the SIR model by adding an exposed compartment.\n\n-   We can model various pharmaceutical and non-pharmaceutical interventions (NPIs) by modifying the transmission rate or adding new compartments.\n\n------------------------------------------------------------------------\n\n-   We have discussed the basic reproduction number, $R0$, which is a key parameter in infectious disease epidemiology.\n\n-   $R0$ is the average number of secondary infections produced by a single infected individual in a completely susceptible population.\n\n-   If $R0 > 1$, the disease will spread in the population; if $R0 < 1$, the disease will die out.\n\n------------------------------------------------------------------------\n\n-   Deriving the basic reproduction number, $R0$, is an essential step in understanding the dynamics of infectious diseases.\n\n-   Deriving $R0$ for the simple SIR model is simple as we just need to study the threshold phenomena.\n\n-   For more complex models, we can use the next-generation matrix approach to derive $R0$.\n\n------------------------------------------------------------------------\n\n-   Often, homogeneous models are not sufficient to capture the complexity of infectious diseases.\n\n-   Incorporating heterogeneity into the models is essential for capturing the complexity of infectious diseases.\n\n-   Age structure is a common form of heterogeneity that can be incorporated into the models.\n\n-   Other forms of heterogeneity include spatial, temporal, and contact heterogeneity.\n\n\n\n---\n\n## What skills are needed to build and use infectious disease models?\n\n\n![A non-exhaustive list of skills needed for modelling.](images/modelling_skills.jpeg)\n\n\n\n# List of Resources\n\n\n## Textbooks\n\n::: {layout-ncol=\"2\"}\n![Infectious Diseases of Humans: Dynamics and Control by Roy M. Anderson and Robert M. May](images/Anderson_and_May.jpeg){width=60%}\n\n![Infectious Disease Modelling by Emilia Vynnycky and Richard White](images/ID_modelling_Vynnycky_and_White.jpeg){width=60%}\n:::\n\n------------------------------------------------------------------------\n\n::: {layout-ncol=\"2\"}\n![Modeling Infectious Diseases in Humans and Animals by Matt Keeling and Pejman Rohani](images/Rohani_and_Keeling.jpeg){width=60%}\n\n![Epidemics: Models and Data Using R by Ottar N. Bjornstad](images/Epidemics_Ottar.jpg){width=60%}\n:::\n\n------------------------------------------------------------------------\n\n## Papers and Articles {.smaller}\n\n------------------------------------------------------------------------\n\n### Modelling infectious disease transmission\n\n-   Grassly, N. C., & Fraser, C. (2008). Mathematical models of infectious disease transmission. Nature Reviews Microbiology, 6(6), 477–487. https://doi.org/10.1038/nrmicro1845\n-   Kirkeby, C., Brookes, V. J., Ward, M. P., Dürr, S., & Halasa, T. (2021). A practical introduction to mechanistic modeling of disease transmission in veterinary science. Frontiers in veterinary science, 7, 546651. https://www.frontiersin.org/articles/10.3389/fvets.2020.546651/full\n\n---\n\n-   Blackwood, J. C., & Childs, L. M. (2018). An introduction to compartmental modeling for the budding infectious disease modeler. https://vtechworks.lib.vt.edu/items/61e9ca00-ef21-4356-bcd7-a9294a1d2f17\n\n------------------------------------------------------------------------\n\n-   Cobey, S. (2020). Modeling infectious disease dynamics. Science, 368(6492), 713–714. https://doi.org/10.1126/science.abb5659\n-   Bjørnstad, O. N., Shea, K., Krzywinski, M., & Altman, N. (2020). Modeling infectious epidemics. Nature Methods, 17(5), 455–456. https://doi.org/10.1038/s41592-020-0822-z\n\n------------------------------------------------------------------------\n\n-   Bodner, K., Brimacombe, C., Chenery, E. S., Greiner, A., McLeod, A. M., Penk, S. R., & Soto, J. S. V. (2021). Ten simple rules for tackling your first mathematical models: A guide for graduate students by graduate students. PLOS Computational Biology, 17(1), e1008539. https://doi.org/10.1371/journal.pcbi.1008539\n-   Mishra, S., Fisman, D. N., & Boily, M.-C. (2011). The ABC of terms used in mathematical models of infectious diseases. Journal of Epidemiology & Community Health, 65(1), 87–94. https://jech.bmj.com/content/65/1/87\n\n------------------------------------------------------------------------\n\n-   James, L. P., Salomon, J. A., Buckee, C. O., & Menzies, N. A. (2021). The Use and Misuse of Mathematical Modeling for Infectious Disease Policymaking: Lessons for the COVID-19 Pandemic. 41(4), 379–385. https://doi.org/10.1177/0272989X21990391\n-   Holmdah, I., & Buckee, C. (2020). Wrong but useful—What COVID-19 epidemiologic models can and cannot tell us. New England Journal of Medicine. https://doi.org/10.1056/nejmp2009027\n\n------------------------------------------------------------------------\n\n-   Metcalf, C. J. E. E., Edmunds, W. J., & Lessler, J. (2015). Six challenges in modelling for public health policy. Epidemics, 10(2015), 93–96. https://doi.org/10.1016/j.epidem.2014.08.008\n-   Roberts, M., Andreasen, V., Lloyd, A., & Pellis, L. (2015). Nine challenges for deterministic epidemic models. Epidemics, 10(2015), 49–53. https://doi.org/10.1016/j.epidem.2014.09.006\n\n------------------------------------------------------------------------\n\n### Deriving and Interpreting R0 {.smaller}\n\n-   Jones, J. H. (2011). Notes On R0. Building, 1–19. https://web.stanford.edu/\\~jhj1/teachingdocs/Jones-on-R0.pdf\n-   Diekmann, O., Heesterbeek, J. A. P., & Metz, J. A. J. (1990). On the definition and the computation of the basic reproduction ratio R0 in models for infectious diseases in heterogeneous populations. Journal of Mathematical Biology, 28(4), 365–382. https://doi.org/10.1007/BF00178324\n\n------------------------------------------------------------------------\n\n-   Diekmann, O., Heesterbeek, J. A. P., & Roberts, M. G. (2010). The construction of next-generation matrices for compartmental epidemic models. Journal of the Royal Society Interface, 7(47), 873–885. https://doi.org/10.1098/rsif.2009.0386\n\n\n\n---\n\n### References {.smaller}\n\n::: {#refs}\n:::\n\n---\n\n![](https://i.creativecommons.org/l/by/4.0/88x31.png) This presentation is made available through a [Creative Commons Attribution 4.0 International License](https://creativecommons.org/licenses/by/4.0/).",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}