{
  "hash": "e467f370972d687c9a6e08ca1a048aba",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Introduction to Infectious Disease Modelling\"\nauthor: \"James Mba Azam, PhD\"\nexecute:\n  echo: true\n# format: clean-revealjs\nformat:\n  revealjs: \n    theme: solarized\n    slide-number: true\n    scrollable: true\n    chalkboard: true\nrevealjs-plugins:\n  - revealjs-text-resizer\nbibliography: references.bib\nlink-citations: true\nengine: knitr\n---\n\n\n# An overview of infectious diseases\n\n## What are infectious diseasess\n\n::: columns\n::: {.column width=\"30%\"}\n![Generic definition of a disease (source: Merriam Webster)](images/disease_definition.png){.lightbox}\n:::\n\n::: {.column width=\"70%\"}\nDepending on what we care about, we can classify diseases according to:\n\n-   Cause (e.g., infectious, non-infectious)\n-   Duration (e.g., acute, chronic)\n-   Mode of transmission (direct or indirect)\n-   Impact on the host (e.g., fatal, non-fatal)\n\nNote that these classifications are not mutually exclusive. Hence, a disease can be classified under more than one category at a time.\n:::\n:::\n\n## How are infectious diseases controlled?\n\n-   In general, infectious disease control aims to reduce disease transmission.\n-   The type of control used depends on the disease and its characteristics.\n-   Broadly, there are two main types of control measures:\n    -   Pharmaceutical interventions (PIs)\n    -   Non-pharmaceutical interventions (NPIs)\n\n------------------------------------------------------------------------\n\n### Pharmaceutical interventions (PIs)\n\n-   Pharmaceutical Interventions are medical interventions that target the pathogen or the host.\n\n-   Examples:\n\n    -   Vaccines,\n    -   Antiviral drugs, and\n    -   Antibiotics.\n\n------------------------------------------------------------------------\n\n### Vaccination\n\n-   Most effective way to prevent infectious diseases.\n-   Activates the host's immune system to produce antibodies against the pathogen.\n-   Generally applied prophylactically to susceptible individuals (before infection); this reduces the risk of infection and disease.\n-   Challenges:\n    -   Take time to develop for new pathogens\n    -   Never 100% effective and limited duration of protection\n    -   Adverse side effects\n    -   Some individuals cannot be vaccinated or refuce vaccination\n    -   Some pathogens mutate rapidly (e.g., influenza virus)\n\n------------------------------------------------------------------------\n\n### Non-pharmaceutical interventions (NPIs)\n\n-   Non-pharmaceutical interventions are measures that do not involve medical interventions.\n\n-   Examples:\n\n    -   Quarantine,\n    -   Physical/social distancing, and\n    -   Mask-wearing.\n\n------------------------------------------------------------------------\n\n### Quarantine\n\n-   *Isolation of individuals who may have been exposed to a contagious disease*.\n-   Advantage is that it's simple and its effectiveness does not depend on the disease.\n-   Disadvantages include:\n    -   Infringement on individual rights\n    -   Can be difficult to enforce\n    -   Can be costly\n    -   Can lead to social stigma\n\n[What type of intervention is contact tracing?]{style=\"color:red;\"}\n\n------------------------------------------------------------------------\n\n### Contact tracing\n\n-   Contact tracing is not necessarily an NPI but is often used to identify likely infected individuals.\n-   It involves identifying, assessing, and managing people who have been exposed to a contagious disease to prevent further transmission.\n-   It is a critical component of infectious disease surveillance and is often used in combination with other control measures.\n\n------------------------------------------------------------------------\n\n[How do we quantify the impact of a control measure?]{style=\"color:red;\"}\n\n# Infectious disease models\n\n## What are infectious disease models?\n\n-   [*Models*]{style=\"color:red;\"} generally refer to conceptual representations of an object or system.\n-   [*Mathematical models*]{style=\"color:red;\"} use mathematics to represent the description of the system.\n-   [*Infectious disease models*]{style=\"color:red;\"} use mathematics/statistics to represent dynamics/spread of infectious diseases.\n\n------------------------------------------------------------------------\n\n-   Mathematical models can be used to link the biological process of disease transmission and the emergent dynamics of infection at the population level.\n-   Models require making some assumptions and abstractions.\n-   By definition, \"all models are wrong, but some are useful\" [@Box1979].\n    -   Good enough models are those that capture the essential features of the system being studied.\n-   \"Wrong\" here means that models are simplifications of reality and do not capture all the complexities of the system being studied. It does not mean that models are useless.\n\n------------------------------------------------------------------------\n\n\\<Insert example of some models and their assumptions and what makes them \"wrong\"\\>\n\n------------------------------------------------------------------------\n\n## (Conflicting) Factors that influence model formulation/choice\n\n-   Accuracy: how well does the model to reproduce observed data and predict future outcomes?\n-   Transparency: is it easy to understand and interpret the model and its outputs? (This is affected by the model's complexity)\n-   Flexibility: the ability of the model to be adapted to different scenarios.\n\n## What are models used for?\n\n-   Generally, models can be used to predict and understand/explain the dynamics of infectious diseases.\n\n[How are these two uses impacted by accuracy, transparency, and flexibility?]{style=\"color:red;\"}\n\n------------------------------------------------------------------------\n\n### Modelling to predict the future course\n\n::: columns\n::: {.column width=\"40%\"}\n-   Must be [accurate]{style=\"color:red;\"} else they will provide an incorrect outlook of the future.\n-   Example of the [prediction of Ebola deaths](https://apnews.com/domestic-news-domestic-news-fbb4fc8921d54201a1c5ca91e5b601f5) during the outbreak in West Africa in 2014/2015.\n-   \"But the estimate proved to be off. Way, way off. Like, 65 times worse than what ended up happening.\"\n:::\n\n::: {.column width=\"60%\"}\n![Controversy over estimates of Ebola deaths](images/wrong_ebola_deaths_estimate.png){.lightbox}\n:::\n:::\n\n------------------------------------------------------------------------\n\n\\< Insert examples of models that have made accurate predictions of the future course of an outbreak \\>\n\n------------------------------------------------------------------------\n\n### Modelling to understand or explain\n\n-   Models can be used to understand how a disease spreads and how its spread can be controlled.\n-   The insights gained from models can be used to:\n    -   inform public health policy and interventions.\n    -   design interventions to control the spread of the disease, for example, randomised controlled trials.\n    -   collect new data.\n    -   build predictive models.\n\n------------------------------------------------------------------------\n\n\\< Insert examples of models that explain the spread and dynamics of infectious diseases \\>\n\n\\< Insert examples of models that evaluate the impact of interventions and determine the next course of action \\>\n\n------------------------------------------------------------------------\n\n## Limitations of infectious disease models\n\n-   Host behaviour is often difficult to predict.\n-   The pathogen often has unknown characteristics or known characteristics that are difficult to model.\n-   Data is often not available or is of poor quality.\n\n------------------------------------------------------------------------\n\n-   Models:\n    -   Simplifications of reality and do not capture all the complexities of the system being studied.\n    -   Only as good as the data used to parameterize them.\n    -   Can be sensitive to the assumptions made during their formulation.\n    -   Can be computationally expensive and require a lot of data to run.\n    -   Can be difficult to interpret and communicate to non-experts.\n\n## What skills are needed to build and use infectious disease models?\n\n-   Mathematical and statistical skills:\n    -   Differential equations.\n    -   Probability and statistics.\n    -   Stochastic processes.\n    -   Numerical analysis\n    -   Time series analyses\n    -   Survival analysis\n\n---\n\n-   Programming skills:\n    -   Proficiency in at least one programming language (e.g., R, Python, Julia, C++).\n    -   Experience with version control (e.g., Git).\n    -   Experience with data manipulation and visualization.\n\n---\n\n-   Domain knowledge in infectious diseases:\n    -   Immunology.\n    -   Epidemiology.\n    -   Virology.\n    -   Genomics\n    \n---\n\n-   Other subject areas:\n\n  - Communication skills:\n    -   Ability to communicate complex ideas to non-experts.\n    -   Ability to write clear and concise reports.\n    -   Ability to present results to a diverse audience.\n  -   Public health.\n  -   Health economics.\n  - Policy analysis.\n\n# Introduction to compartmental models\n\n## What are compartmental models?\n\n-   Compartmental models divide populations into compartments (or groups) based on individual's infection status [@Blackwood2018a].\n-   Individuals move between compartments based on defined transition quantities.\n-   Any particular individual can only be in one compartment at a time.\n\n------------------------------------------------------------------------\n\n::: columns\n::: {.column width=\"40%\"}\n-   They divide the population into compartments based on the [disease status]{style=\"color:red;\"} of individuals.\n-   The most common compartments are:\n    -   Susceptible (S) - hosts are not infected but can be infected\n    -   Infected (I) - hosts are infected (and can infect others)\n    -   Removed (R) - hosts are no longer infected and cannot be re-infected\n-   In compartmental models, individuals move between compartments based on defined transition quantities.\n:::\n\n::: {.column width=\"60%\"}\n![Infection timeline illustrating how a pathogen in a host interacts with the host's immune system (source: Modelling Infectious Diseases of Humans and Animals)](images/infection_timeline.png){.lightbox}\n:::\n:::\n\n------------------------------------------------------------------------\n\n-   Other compartments can be added to the model to account for important events or processes (e.g., exposed, recovered, vaccinated, etc.)\n\n-   It is, however, important to keep the model simple, less computationally intensive, and interpretable.\n\n# Some simple compartmental models\n\n-   We are going to consider infections that either confer immunity after recovery or not.\n-   The simplest compartmental models for capturing this are the SIS and SIR models.\n\n## The Susceptible-Infected-Recovered model (SIR)\n\n- SIR models are used to model diseases that confer immunity after recovery.\n\n- The SIR model groups individuals into three _disease states_:\n  - Susceptible (S): individuals who are not infected and can be infected.\n  - Infected (I): individuals who are infected and can infect others.\n  - Removed (R): individuals who have recovered from the infection and are immune.\n \n- This framework was popularised by Kermack and McKendrick in 1927 [@kermack1927contribution]\n  - A must-read paper for anyone interested in infectious disease modelling.\n\n---\n\n![Diagram of an SIR/SIRS model](images/sir_sirs_model.png){.lightbox}\n\n## Model equations\n\n- The SIR model is described by the following set of differential equations:\n\n\\begin{aligned}\n\\frac{dS}{dt} & = \\color{orange}{-\\beta \\frac{S I}{N}} \\\\\n\\frac{dI}{dt} & = \\color{orange}{\\beta \\frac{S I}{N}} - \\color{cornflowerblue}{\\gamma I} \\\\\n\\frac{dR}{dt} & = \\color{cornflowerblue}{\\gamma I}\n\\end{aligned}\n\nWith initial conditions $S(0) = S_0$, $I(0) = I_0$, and $R(0) = R_0$.\n\nwhere:\n\n- $N$ is the total population size.\n- $\\beta$ is the transmission rate.\n- $\\gamma$ is the recovery rate.\n\n---\n\n- The model cannot be solved analytically, so numerical methods are used to solve the equations.\n\n- However, we can gain insights into the dynamics of the model by qualitatively analysing the equations.\n\n---\n\n## Solving the SIR model in R\n\n- To solve the model in R, we will always need to define at least three things:\n  - The model equations.\n  - The parameter values.\n  - The initial conditions.\n\n- We will need the `deSolve` package to solve the model.\n\n---\n\n- Let's start by defining the model equations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define the SIR model\nsir_model <- function(t, state, parameters) {\n  with(as.list(c(state, parameters)), {\n    dS <- -beta * S * I\n    dI <- beta * S * I - gamma * I\n    dR <- gamma * I\n    return(list(c(dS, dI, dR)))\n  })\n}\n```\n:::\n\n\n---\n\nNext, we will define the parameter values and initial conditions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# define parameters we know\nN  <- 1000  \nR0 <- 2\ninfectious_period <- 7\n\n# Remember gamma <- 1/ infectious_period as discussed earlier\ngamma <- 1/infectious_period \n\n# We will use R0 = beta N / gamma  instead because it is easier to interpret.\n# beta is not directly interpretable.\n\nparams <- c(beta = R0 * gamma / N, gamma = gamma)\n\n# Initial conditions for S, I, R\n# Why is S = N - 1?\ninits <- c(S = N - 1, I = 1, R = 0)\n\n# Time steps to return results\ndt <- 1:150\n```\n:::\n\n\n---\n\nFinally, we will solve the model using the `ode` function from the `deSolve` package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Solve the model\nresults <- deSolve::ode(\n  y = inits,\n  times = dt,\n  func = sir_model,\n  parms = params\n)\n\n# Make it a data.frame\nresults <- as.data.frame(results)\n```\n:::\n\n\n---\n\nNow, let's plot the results.\n\n\n::: {.cell output-location='slide'}\n\n```{.r .cell-code}\n# Load the necessary libraries\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\n# Create data for ggplot2 by reshaping\nresults_long <- results |> \n  pivot_longer(cols = c(2:4), names_to = \"compartment\", values_to = \"value\")\n  \nplot <- ggplot(data = results_long,\n  aes(x = time, y = value, color = compartment)\n  ) +\ngeom_line(linewidth = 1) +\nlabs(\n  title = \"SIR model\",\n  x = \"Time\",\n  y = \"Number of individuals\"\n) \nprint(plot)\n```\n\n::: {.cell-output-display}\n![](slides_files/figure-revealjs/plot-sir-1.png){width=960}\n:::\n:::\n\n\n---\n\n## Model assumptions\n\n- There are no inflows or outflows from the population, i.e., no births, deaths, or migration. This is often described as a _closed population_.\n - That is, the epidemic occurs much faster than the time scale of births, deaths, or migration.\n\n- Mixing is homogeneous, i.e., individuals mix randomly and have an equal probability of coming into contact with any other individual in the population.\n\n- Transition rates are constant and do not change over time.\n\n- When this assumption is \"relaxed\"/included, we get more complex models.\n\n---\n\n## Transitions between compartments\n\n- There are two processes that govern the transitions between compartments:\n  - Transmission, governed by the transmission rate, $\\beta$ (rate at which susceptible individuals become infected).\n  - Recovery, governed by the recovery rate, $\\gamma$ (rate at which infected individuals recover and become immune).\n  \n---\n\n### Transmission\n\n[What factors drive transmission?]{style=\"color:orange;\"}\n\n---\n\n- Transmission is driven by several factors:\n  - The prevalence, [$I$]{style=\"color:orange;\"}, i.e., number of infected individuals at the time.\n  - The number of contacts, [$C$]{style=\"color:orange;\"}, susceptible individuals have with infected individual.\n  - The probability, [$p$]{style=\"color:orange;\"}, a susceptible individual will become infected when they contact an infected individual.\n\n---\n\n- The transmission term is often defined through the force of infection (FOI), $\\lambda$:\n  - The force of infection is the [per capita rate]{style=\"color:orange;\"} at which susceptible individuals become infected.\n\n- The rate at which new infecteds are generated is given by [$\\lambda S$]{style=\"color:orange;\"}, where $S$ is the number of susceptible individuals.\n\n- The force of infection is proportional to the number of infected individuals and the transmission rate, [$\\beta$]{style=\"color:orange;\"}.\n\n- $\\beta$ is the product of the contact rate and the probability of transmission per contact.\n\n---\n\n- The FOI can be formulated in two ways, depending on how the contact rate is expected to change with the population size:\n  - [_Frequency-dependent/mass action transmission_]{style=\"color:orange;\"}: The rate of contact between individuals is proportional to the population size. Here, [$\\lambda = \\beta \\times \\dfrac{I}{N}$]{style=\"color:orange;\"}.\n  - [_Density dependent transmission_]{style=\"color:orange;\"}: The rate of contact between individuals is independent of the population size. Here, [$\\lambda = \\beta \\times I$]{style=\"color:orange;\"}.\n\n---\n\n- Frequency-dependent transmission assumes that that the number of contacts an individual has is independent of the population size:\n  - Often used to model vector-borned diseases and diseases with heterogeneity in contact rates.\n\n---\n\n- Density-dependent transmission assumes that the number of contacts an individual has is proportional to the population size:\n  - Often used to model diseases that allow the safe assumption of random/homogenous mixing.\n\n::: {.callout-note}\nThe differences become important when dealing with population sizes that change significantly over time.\n:::\n\n---\n\n- The recovery rate $\\gamma$ is the reciprocal of the average duration of the infection. That is, infected individuals spend $1/\\gamma$ days in the infected compartment before recovering.\n\n- The average infectious period is often estimated from epidemiological data.\n\n\n# The Susceptible-Infected-Susceptible model (SIS)\n\n-   The SIS model has two compartments: Susceptible (S) and Infected (I).\n\n<Insert SIS model diagram>\n\n<!-- ### An SIR Shiny App -->\n\n<!-- ```{r} -->\n\n<!-- library(shinySIR) -->\n\n<!-- shinySIR::run_shiny(model = \"SIR\") -->\n\n<!-- ``` -->\n\n-   We assume that individuals are susceptible to infection, become infected, and then either recover become susceptible again or become immune.\n\n[What kinds of diseases can be modelled using the SIS and SIR models?]{style=\"color:red;\"}\n\n------------------------------------------------------------------------\n\n# The Basic Reproduction Number\n\n# Analyzing Model Outputs and Dynamics\n\n# Wrap-Up and Q&A\n\n# List of Resources\n\n## Textbooks\n\n-   [Modeling Infectious Diseases in Humans and Animals by Matt Keeling and Pejman Rohani](https://www.amazon.co.uk/Modeling-Infectious-Diseases-Humans-Animals/dp/0691116172) -[Epidemics: Models and Data Using R by Ottar N. Bjornstad](https://link.springer.com/book/10.1007/978-3-031-12056-5)\n-   [Infectious Disease Modelling by Emilia Vynnycky and Richard White](https://www.amazon.co.uk/Introduction-Infectious-Disease-Modelling/dp/0198565763)\n-   [Infectious Diseases of Humans: Dynamics and Control by Roy M. Anderson and Robert M. May](https://www.amazon.co.uk/Infectious-Diseases-Humans-Dynamics-Control/dp/019854040X)\n\n## Papers and Articles {.scrollable}\n\n### Modelling infectious disease transmission\n\n-   [Kirkeby, C., Brookes, V. J., Ward, M. P., Dürr, S., & Halasa, T. (2021). A practical introduction to mechanistic modeling of disease transmission in veterinary science. Frontiers in veterinary science, 7, 546651.](https://www.frontiersin.org/articles/10.3389/fvets.2020.546651/full)\n-   [Blackwood, J. C., & Childs, L. M. (2018). An introduction to compartmental modeling for the budding infectious disease modeler.](https://vtechworks.lib.vt.edu/items/61e9ca00-ef21-4356-bcd7-a9294a1d2f17)\n-   [Grassly, N. C., & Fraser, C. (2008). Mathematical models of infectious disease transmission. Nature Reviews Microbiology, 6(6), 477–487.](https://doi.org/10.1038/nrmicro1845)\n-   [Cobey, S. (2020). Modeling infectious disease dynamics. Science, 368(6492), 713–714.](https://doi.org/10.1126/science.abb5659)\n-   [Bjørnstad, O. N., Shea, K., Krzywinski, M., & Altman, N. (2020). Modeling infectious epidemics. Nature Methods, 17(5), 455–456.](https://doi.org/10.1038/s41592-020-0822-z)\n-   [Bodner, K., Brimacombe, C., Chenery, E. S., Greiner, A., McLeod, A. M., Penk, S. R., & Soto, J. S. V. (2021). Ten simple rules for tackling your first mathematical models: A guide for graduate students by graduate students. PLOS Computational Biology, 17(1), e1008539.](https://doi.org/10.1371/journal.pcbi.1008539)\n-   [Mishra, S., Fisman, D. N., & Boily, M.-C. (2011). The ABC of terms used in mathematical models of infectious diseases. Journal of Epidemiology & Community Health, 65(1), 87–94.](https://jech.bmj.com/content/65/1/87)\n-   [James, L. P., Salomon, J. A., Buckee, C. O., & Menzies, N. A. (2021). The Use and Misuse of Mathematical Modeling for Infectious Disease Policymaking: Lessons for the COVID-19 Pandemic. 41(4), 379–385.](https://doi.org/10.1177/0272989X21990391)\n-   [Holmdah, I., & Buckee, C. (2020). Wrong but useful—What COVID-19 epidemiologic models can and cannot tell us. New England Journal of Medicine.](https://doi.org/10.1056/nejmp2009027)\n-   [Metcalf, C. J. E. E., Edmunds, W. J., & Lessler, J. (2015). Six challenges in modelling for public health policy. Epidemics, 10(2015), 93–96.](https://doi.org/10.1016/j.epidem.2014.08.008)\n-   [Roberts, M., Andreasen, V., Lloyd, A., & Pellis, L. (2015). Nine challenges for deterministic epidemic models. Epidemics, 10(2015), 49–53.](https://doi.org/10.1016/j.epidem.2014.09.006)\n\n### Deriving and Interpreting R0\n\n-   [Jones, J. H. (2011). Notes On R0. Building, 1–19.](https://web.stanford.edu/~jhj1/teachingdocs/Jones-on-R0.pdf)\n-   [Diekmann, O., Heesterbeek, J. A. P., & Metz, J. A. J. (1990). On the definition and the computation of the basic reproduction ratio R0 in models for infectious diseases in heterogeneous populations. Journal of Mathematical Biology, 28(4), 365–382.](https://doi.org/10.1007/BF00178324)\n-   [Diekmann, O., Heesterbeek, J. A. P., & Roberts, M. G. (2010). The construction of next-generation matrices for compartmental epidemic models. Journal of the Royal Society Interface, 7(47), 873–885.](https://doi.org/10.1098/rsif.2009.0386)\n\n### References\n\n::: {#refs}\n:::\n",
    "supporting": [
      "slides_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}